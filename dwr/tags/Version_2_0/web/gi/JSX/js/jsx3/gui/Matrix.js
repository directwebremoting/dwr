/*
 * Copyright (c) 2001-2007, TIBCO Software Inc.
 * Use, modification, and distribution subject to terms of license.
 */
jsx3.require("jsx3.xml.Cacheable","jsx3.gui.Form","jsx3.gui.Block","jsx3.gui.Matrix.Column");jsx3.Class.defineClass("jsx3.gui.Matrix",jsx3.gui.Block,[jsx3.gui.Form,jsx3.xml.Cacheable,jsx3.xml.CDF],function(b,f){var X=jsx3.util.Logger.getLogger(b.jsxclass.getName());var rc=jsx3.gui.Event;var ic=jsx3.gui.Interactive;var bc=jsx3.xml.CDF;var w=jsx3.gui.Block;var B=jsx3.gui.Painted.Box;b.cv=500;b._B=1;b.fv=150;b.AUTO_SCROLL_INTERVAL=50;b.SELECTION_BG="jsx:///images/matrix/select.gif";b.INSERT_BEFORE_IMG=jsx3.resolveURI("jsx:///images/matrix/insert_before.gif");b.APPEND_IMG=jsx3.resolveURI("jsx:///images/matrix/append.gif");b.FOCUS_STYLE="font-weight:bold";b.ICON_MINUS="jsx:///images/matrix/minus.gif";b.ICON_PLUS="jsx:///images/matrix/plus.gif";b.ICON="jsx:///images/matrix/file.gif";b.SORT_ASCENDING="ascending";b.SORT_DESCENDING="descending";b.SORT_DESCENDING_IMG=jsx3.resolveURI("jsx:///images/matrix/sort_desc.gif");b.SORT_ASCENDING_IMG=jsx3.resolveURI("jsx:///images/matrix/sort_asc.gif");b.MINIMUM_COLUMN_WIDTH=8;b.DEFAULT_HEADER_HEIGHT=20;b.AUTOROW_NONE=0;b.AUTOROW_LAST_ROW=1;b.AUTOROW_FIRST_ROW=2;b.rF=new jsx3.util.MessageFormat("<xsl:call-template xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" name=\"{0}\">\n  <xsl:with-param name=\"jsx_is_first_panel_row\" select=\"$jsx_is_first_panel_row\"/>\n  <xsl:with-param name=\"jsx_row_number\" select=\"$jsx_row_number\"/>\n  <xsl:with-param name=\"jsx_rowbg\" select=\"$jsx_rowbg\"/>\n  <xsl:with-param name=\"jsx_cdfkey\" select=\"$jsx_cdfkey\"/>\n  <xsl:with-param name=\"jsx_descendant_index\" select=\"$jsx_descendant_index\"/>\n</xsl:call-template>");b.so=new jsx3.util.MessageFormat("<xsl:when xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" test=\"$jsx_cell_value_template_id=''{0}''\">\n  <xsl:for-each select=\"//*[@jsxid=$jsx_record_context]\">\n    <xsl:call-template name=\"{0}\">\n    </xsl:call-template>\n  </xsl:for-each>\n</xsl:when>\n");b.ld=new jsx3.util.MessageFormat("<xsl:template xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" name=\"{0}\">\n  <xsl:param name=\"jsx_is_first_panel_row\"/>\n  <xsl:param name=\"jsx_row_number\"/>\n  <xsl:param name=\"jsx_rowbg\"/>\n  <xsl:param name=\"jsx_cdfkey\"/>\n  <xsl:param name=\"jsx_descendant_index\"/>\n  <xsl:param name=\"jsx_selection_bg\"><xsl:choose>\n     <xsl:when test=\"@jsxselected=1\">background-image:url(<xsl:value-of select=\"$jsx_selection_bg_url\"/>);</xsl:when>\n   </xsl:choose></xsl:param>\n  <xsl:param name=\"jsx_cell_width\" select=\"##JSX_REPLACE##\"/>\n  <xsl:param name=\"jsx_true_width\">\n    <xsl:choose><xsl:when test=\"$jsx_use_categories!=''0'' and not(@jsxcategory=''0'') and (@jsxcategory or record)\">##JSX_REPLACE_ALL##</xsl:when><xsl:otherwise><xsl:value-of select=\"$jsx_cell_width\"/></xsl:otherwise></xsl:choose>\n  </xsl:param>\n  <xsl:param name=\"jsx_first_row_width_style\">\n    <xsl:choose><xsl:when test=\"$jsx_is_first_panel_row\">width:<xsl:value-of select=\"$jsx_true_width\"/>px;</xsl:when></xsl:choose>\n  </xsl:param>\n  <xsl:param name=\"jsx_colspan\">\n    <xsl:choose><xsl:when test=\"$jsx_use_categories!=''0'' and not(@jsxcategory=''0'') and (@jsxcategory or record)\"><xsl:value-of select=\"$jsx_column_count\"/></xsl:when><xsl:otherwise>1</xsl:otherwise></xsl:choose>\n  </xsl:param>\n  {1}\n</xsl:template>");b.wB=new jsx3.util.MessageFormat("<xsl:call-template name=\"{0}\">\n  <xsl:with-param name=\"jsx_cell_width\" select=\"$jsx_true_width\"/>\n  <xsl:with-param name=\"jsx_row_number\" select=\"$jsx_row_number\"/>\n  <xsl:with-param name=\"jsx_descendant_index\" select=\"$jsx_descendant_index\"/>\n</xsl:call-template>");b.DEFAULT_INFO_LABEL="Viewing rows {0} to {1} of {2}";b.ON_PAINT_PAGE="jsxpaintpage";b.PAGING_OFF=0;b.PAGING_2PASS=1;b.PAGING_CHUNKED=2;b.PAGING_PAGED=3;b.PAGING_STEPPED=4;b.SELECTION_UNSELECTABLE=0;b.SELECTION_ROW=1;b.SELECTION_MULTI_ROW=2;b.DEFAULT_ROW_HEIGHT=20;b.DEFAULT_PANEL_POOL_COUNT=5;b.DEFAULT_ROWS_PER_PANEL=50;b.DEFAULT_REAPER_INTERVAL=250;b.DEFAULT_PANEL_QUEUE_SIZE=3;b.DEFAULT_XSL_URL=jsx3.resolveURI("jsx:///xsl/jsxmatrix.xsl");f._jsxUq=[];f.init=function(q){this.jsxsuper(q);};f.k7=function(m,j,e){var O=this.RL(true,m);delete this._jsxwg;var cb=B.getScrollSize()+1;var fb=this.getScaleWidth()==1?m.parentwidth-cb:this.zF();var kb=this.getHeaderHeight(b.DEFAULT_HEADER_HEIGHT);O.recalculate(m,j,e);var Yb=O.pQ(0);Yb.recalculate({parentwidth:this.Ji(),parentheight:kb},j?j.childNodes[0]:null,e);var zb=Yb.pQ(0).pQ(0);zb.recalculate({parentwidth:fb,parentheight:kb},j&&j.childNodes[0]?jsx3.html.selectSingleElm(j,0,0,0):null,e);var Y=O.P5()-kb;var kc=O.pQ(1);kc.recalculate({parentwidth:this.Ji(),parentheight:Y},j?j.childNodes[1]:null,e);Y=O.P5()-this.getHeaderHeight(b.DEFAULT_HEADER_HEIGHT);var zc={};zc.left=kc.jU();zc.top=0;zc.height=kc.P5()+this.getHeaderHeight(b.DEFAULT_HEADER_HEIGHT)-(cb-B.getScrollSizeOffset("scroll"));var sb=O.pQ(2);sb.recalculate(zc,j?j.childNodes[2]:null,e);var Ob={};Ob.top=kc.G_()+kc.P5()+this.getHeaderHeight(b.DEFAULT_HEADER_HEIGHT)-cb;Ob.width=kc.XK();var yb=O.pQ(3);yb.recalculate(Ob,j?j.childNodes[3]:null,e);var Q=yb.pQ(0);var mb=this.getScaleWidth()||fb-cb<=O.XK()?0:fb;Q.recalculate({width:mb},j&&j.childNodes[3]?j.childNodes[3].childNodes[0]:null,e);if(j&&j.childNodes[3]){if(this.getSuppressHScroller(0)==1||this.getScaleWidth()==1||Q.XK()<=yb.XK()){j.childNodes[3].style.display="none";this.setScrollLeft(0);}else{j.childNodes[3].style.display="block";}}var Hc={};Hc.left=kc.jU();Hc.top=kc.G_()+kc.P5()+this.getHeaderHeight(b.DEFAULT_HEADER_HEIGHT)-cb;var Rb=O.pQ(4);Rb.recalculate(Hc,j&&j.childNodes[4]?j.childNodes[4]:null,e);var vb=this.pi();var H=this.Mv(kc.XK());for(var Tb=0;Tb<vb.length;Tb++)vb[Tb].k7({parentwidth:H[Tb],parentheight:kb},j?vb[Tb].getRendered():null,e);if(j&&j.childNodes[0]){var mc=[];for(var Tb=0;Tb<vb.length;Tb++)mc.push(vb[Tb].RL(true).KZ());this.Ln(j.childNodes[0].childNodes[0],mc);H=[];for(var Tb=0;Tb<vb.length;Tb++)H.push(vb[Tb].RL(true).jU());this.GG(j.childNodes[0].childNodes[0],H);mc=[];for(var Tb=0;Tb<vb.length;Tb++)mc.push(vb[Tb].RL(true).pQ(1).KZ());if(this.getRenderingModel()=="hierarchical"){var Lc=this.Lv({contextnodes:j.childNodes[1].childNodes[0].childNodes});this.Ig(Lc,mc);}else{this.Ln(j.childNodes[1].childNodes[0],mc);}this._p();}else{X.trace("Race condition with view...");var R=this;jsx3.sleep(function(){if(this.getParent())this.nW(this.getParent().IO(this),true);},null,this);}};f.GG=function(j,p){var Fc=0;for(var R=1;R<j.childNodes.length;R++){var t=j.childNodes[R];Fc=Fc+p[R-1];t.style.left=Fc-4+"px";}};f.Ln=function(a,g){var Gc=this.zF();for(var tc=0;tc<a.childNodes.length;tc++){var Ic=a.childNodes[tc];if(Ic.tagName.toLowerCase()=="table"){Ic.style.width=Gc+"px";var Vb=this.hg(Ic);if(Vb){for(var z=0;z<Vb.childNodes.length;z++){Vb.childNodes[z].style.width=g[z]+"px";}}}}};f.Ig=function(o,p){var Vb=this.zF();var Hc=Vb-this.Mv()[0]+p[0];for(var G=0;G<o.length;G++){var Ib=o[G];if(!(Ib&&Ib.childNodes))continue;var jc=Ib.parentNode;if(jc.tagName.toLowerCase()!="table")jc=jc.parentNode;var Mb=Vb-parseInt(jc.style.width);jc.style.width=Vb+"px";for(var Cb=0;Cb<Ib.childNodes.length;Cb++){var wc=Cb==0&&Ib.childNodes[0].getAttribute("jsxcolspan")>1?Hc:p[Cb];Ib.childNodes[Cb].style.width=wc+"px";if(Cb==0&&this.getRenderNavigators(1)!=0){jc=Ib.childNodes[Cb].childNodes[0].childNodes[0];var M=wc-parseInt(jc.style.left)-1;jc.style.width=Math.max(0,M)+"px";var ib=this.hg(jc);}}}};f.zF=function(r){if(!r)r=this.Mv();return eval(r.join("0+")+"0")/10;};f.Mv=function(n){if(typeof(this._jsxwg)=="object"){return this._jsxwg.truewidths;}else{if(!n){n=this.Ji();var hb={width:1000,height:10};var xc=this.getBodyBorder();if(xc!=null&&xc!="")hb.border=xc;n=n-(hb.width-(new B(hb)).XK());}var ec=[];var F=0;var Jb;var Fc=0;var Ec=this.pi();var Xb={percent:[],wildcard:[],pixel:[]};for(var mc=0;mc<Ec.length;mc++){var hc=Ec[mc].getWidth();if((hc+"").trim().search(/\d*%/)==0){Xb.percent.unshift(mc);Jb=parseInt(parseInt(hc)/100*n);}else{if(!isNaN(hc)){Xb.pixel.unshift(mc);Jb=Number(hc);}else{Xb.wildcard.unshift(mc);if(this.getScaleWidth()){Fc++;Jb="*";}else{Jb=jsx3.gui.Matrix.Column.DEFAULT_WIDTH;}}}if(!isNaN(Jb))F=F+Jb;ec.push(Jb);}X.trace("Matrix Width Recalc, Pass 1 ("+this.getName()+"): "+ec);if(this.getScaleWidth()){var gc=n-F;var Pb;if(Fc&&gc>=0&&parseInt(gc/Fc)>b.MINIMUM_COLUMN_WIDTH){var ab=Fc;var kb=gc/Fc;if(kb>parseInt(kb)){kb=parseInt(kb);Pb=gc-(Fc-1)*kb;}else{Pb=kb;}for(var mc=0;mc<ec.length;mc++){if(ec[mc]=="*"){ec[mc]=Fc==1?Pb:kb;Fc--;}}Fc=ab;}else{if(Fc){for(var mc=0;mc<ec.length;mc++){if(ec[mc]=="*")ec[mc]=b.MINIMUM_COLUMN_WIDTH;}}}X.trace("Matrix Width Recalc, Pass 2a ("+this.getName()+"): "+ec);var S=this.zF(ec);var R=S-n;if(R>0){var cc=R;if(Xb.wildcard.length)cc=this.FB(ec,Xb.wildcard,R);if(Xb.percent.length&&cc>0)cc=this.FB(ec,Xb.percent,cc);if(Xb.pixel.length&&cc>0)cc=this.FB(ec,Xb.pixel,cc);}X.trace("Matrix Width Recalc, Pass 2b ("+this.getName()+"): "+ec);}for(var mc=0;mc<ec.length;mc++){if(ec[mc]<b.MINIMUM_COLUMN_WIDTH)ec[mc]=b.MINIMUM_COLUMN_WIDTH;}X.trace("Matrix Width Recalc, Pass 3 ("+this.getName()+"): "+ec);var S=this.zF(ec);var gc=n-S;if(gc>0)ec[ec.length-1]+=gc;X.trace("Matrix Width Recalc, Pass 4 ("+this.getName()+"): "+ec);this._jsxwg={truewidths:ec};return ec;}};f.FB=function(j,n,l){var nb=0;var P=parseInt(l/n.length);for(var M=0;M<n.length;M++){var I=n[M];if(M==n.length-1)P=l-(n.length-1)*P;if(j[I]-P<b.MINIMUM_COLUMN_WIDTH){nb=nb+(b.MINIMUM_COLUMN_WIDTH-(j[I]-P));j[I]=b.MINIMUM_COLUMN_WIDTH;}else{j[I]-=P;}}return nb;};f.Ji=function(){var hb=this.getParent().IO(this).parentwidth;return this.getSuppressVScroller(0)==1?hb:hb-B.getScrollSize();};f.IO=function(g){var D=g.getDisplayIndex();return {parentwidth:D!=null?this.Mv()[D]:null,parentheight:this.RL(true).pQ(0).P5()};};f.T5=function(p){this.applyDynamicProperties();if(this.getParent()&&(p==null||isNaN(p.parentwidth)||isNaN(p.parentheight))){p=this.getParent().IO(this);this.Wc();}else{if(p==null){p={};}}var vb=B.getScrollSize()+1;p.left=0;p.top=0;p.width="100%";p.height="100%";p.boxtype="box";p.tagname="div";var A=new B(p);var dc=this.getScaleWidth()==jsx3.Boolean.TRUE?this.Ji():this.zF();var Ab={};Ab.left=0;Ab.top=0;Ab.height=this.getHeaderHeight(b.DEFAULT_HEADER_HEIGHT);Ab.width="100%";Ab.parentwidth=this.Ji();Ab.boxtype="box";Ab.tagname="div";var H;if((H=this.getHeaderBorder())!=null&&H!="")Ab.border=H;var Z=new B(Ab);A.W8(Z);var K={};K.tagname="div";K.boxtype="box";K.top=0;K.left=0;var ac=new B(K);Z.W8(ac);var ib={};ib.left=0;ib.top=0;ib.width="100%";ib.parentwidth=Z.XK();ib.boxtype="box";ib.tagname="table";var qb=new B(ib);ac.W8(qb);var T={};T.boxtype="inline";T.tagname="tr";var Ub=new B(T);qb.W8(Ub);var kb=A.P5()-this.getHeaderHeight(b.DEFAULT_HEADER_HEIGHT);var Sb={};Sb.left=0;Sb.top=this.getHeaderHeight(b.DEFAULT_HEADER_HEIGHT);Sb.parentwidth=this.Ji();Sb.width="100%";Sb.parentheight=kb;Sb.height="100%";Sb.boxtype="box";Sb.tagname="div";if((H=this.getBodyBorder())!=null&&H!="")Sb.border=H;var Ic=new B(Sb);A.W8(Ic);if(this.getHeaderHeight()!=0&&Z.explicit.borderwidth!=Ic.explicit.borderwidth)X.warn("If the header border and body border do not share the same pixel width, the columns in the matrix may not align as expected ("+this.getName()+")\nHeader Border ("+this.getHeaderBorder()+") != Body Border ("+this.getBodyBorder()+")");var Nb={};Nb.tagname="div";Nb.boxtype="box";Nb.top=0;Nb.left=0;var Kc=new B(Nb);Ic.W8(Kc);var Hb={};Hb.boxtype="box";Hb.tagname="div";Hb.left=Ic.jU();Hb.top=0;Hb.width=vb;Hb.height=Ic.P5()+this.getHeaderHeight(b.DEFAULT_HEADER_HEIGHT)-(vb-B.getScrollSizeOffset("scroll"));var Gb=new B(Hb);A.W8(Gb);var Dc={};Dc.boxtype="inline";Dc.tagname="img";Dc.empty=true;Dc.left=0;Dc.top=0;Dc.width=1;Dc.height=this.getPagingModel()!=b.PAGING_PAGED?0:this.Qj()+this.getHeaderHeight(b.DEFAULT_HEADER_HEIGHT);var zb=new B(Dc);Gb.W8(zb);var Qb={};Qb.boxtype="box";Qb.tagname="div";Qb.left=Ic.jJ();Qb.top=Ic.G_()+Ic.P5()+this.getHeaderHeight(b.DEFAULT_HEADER_HEIGHT)-vb;Qb.height=vb;Qb.width=Ic.XK();var Db=new B(Qb);A.W8(Db);var rb={};rb.boxtype="inline";rb.tagname="img";rb.empty=true;rb.left=0;rb.top=0;rb.width=dc-vb<=A.XK()?0:dc;rb.height=1;var U=new B(rb);Db.W8(U);var _b={};_b.boxtype="box";_b.tagname="div";_b.left=Ic.jU();_b.top=Ic.G_()+Ic.P5()+this.getHeaderHeight(b.DEFAULT_HEADER_HEIGHT)-vb;_b.width=vb;_b.height=vb;var Tb=new B(_b);A.W8(Tb);return A;};b.s5={};b.s5[rc.MOUSEOVER]=true;b.s5[rc.MOUSEOUT]=true;b.s5[rc.DOUBLECLICK]=true;b.s5[rc.KEYDOWN]=true;b.s5[rc.MOUSEDOWN]=true;b.s5[rc.CLICK]=true;b.s5[rc.MOUSEUP]=true;f.paint=function(){this.applyDynamicProperties();var Wb=this.getId();var Ac=this.RL(true);Ac.setAttributes("id=\""+Wb+"\" class=\"jsx30matrix\" "+this.RX("mouseup","_onMouseUp"));var Fc=this.lM(b.s5,1);var vc=Ac.pQ(1);vc.setAttributes("id=\""+Wb+"_body\" class=\"jsx30matrix_body\" "+Fc);var oc=vc.pQ(0);oc.setStyles(this.UZ()+this.K2());var uc=Ac.pQ(2);uc.setAttributes(this.RX("scroll","OA")+this.RX("mouseover","Tr")+this.RX("mouseout","Yn")+this.RX("mousemove","lt")+this.RX("mousedown","hx")+" unselectable=\"on\" class=\"jsx30matrix_scrollv\"");var Ec=this.getSuppressVScroller(0)==1?"display:none;":"";uc.setStyles("z-index:10;overflow:scroll;"+Ec);var Xb=uc.pQ(0);Xb.setAttributes("src=\""+w.SPACE+"\"");var cc=Ac.pQ(3);cc.setAttributes(this.RX("scroll","VG")+this.RX("mousedown","oD")+" unselectable=\"on\" class=\"jsx30matrix_scrollh\"");Ec=this.getSuppressHScroller(0)==1||this.getScaleWidth()==1||cc.pQ(0).XK()<=cc.XK()?"display:none;":"";cc.setStyles("z-index:10;overflow:auto;"+Ec);var wc=cc.pQ(0);wc.setAttributes("src=\""+w.SPACE+"\"");var U=Ac.pQ(4);U.setStyles("overflow:hidden;background-color:#e8e8f5;z-index:11;");jsx3.sleep(this.ut,"ut"+this.getId(),this);var ac="";var kc=this.getPagingModel(b.PAGING_OFF);if(kc==b.PAGING_OFF||kc==b.PAGING_STEPPED){if(this.Lh()==2)ac=ac+this.Qn(-1);ac=ac+this.Qn(0);if(this.Lh()==1)ac=ac+this.Qn(-1);}var H=this.Dm(true);var Lc=this.RX("mouseout","_ebMouseOutDropIcon");var x=Ac.paint().join(this.az()+vc.paint().join(oc.paint().join(ac+H))+uc.paint().join(Xb.paint().join(""))+cc.paint().join(wc.paint().join(""))+U.paint().join("&#160;")+"<div class=\"jsx30matrix_scroll_info\"><span class=\"jsx30matrix_scroll_info\">&#160;</span></div>"+"<div class=\"jsx30matrix_resize_bar\">&#160;</div>"+"<div class=\"jsx30matrix_drop_icon\" "+Lc+">&#160;</div>");return x;};f.Dm=function(a){var Nb=this.getPagingModel(b.PAGING_OFF);if(a&&(Nb==b.PAGING_OFF||Nb==b.PAGING_STEPPED)||!a&&!(Nb==b.PAGING_OFF||Nb==b.PAGING_STEPPED)){var vb=this.pi();var tb=[];for(var Gb=0;Gb<vb.length;Gb++){var A=vb[Gb];var cb=A.getEditMasks();for(var Kb=0;Kb<cb.length;Kb++){var _=cb[Kb];if(this.rj(_,A)){if(_.emGetType()==b.EditMask.NORMAL||_.emGetType()==b.EditMask.DIALOG)tb.push(_);}}}return this.paintChildren(tb);}return "";};f.resetMask=function(){this.endEditSession();};f.repaintData=function(){var pb=this.pl();if(pb){var Q=this.getScrollTop();var Yb="";var pc=this.getPagingModel(b.PAGING_OFF);if(pc==b.PAGING_OFF||pc==b.PAGING_STEPPED){this.pu();if(this.Lh()==2)Yb=Yb+this.Qn(-1);Yb=Yb+this.Qn(0);if(this.Lh()==1)Yb=Yb+this.Qn(-1);Yb=Yb+this.Dm(true);}pb.innerHTML=Yb;this.ut(false);jsx3.sleep(function(){this.oo(Q);},null,this);}};f.oo=function(k){var Zb=this.pl();if(k==null)k=this.getScrollTop();var tb=Zb?Zb.offsetHeight:0;if(tb<k){this.setScrollTop(tb);}else{this.setScrollTop(k);}this._p(Zb);};f.az=function(){var rb=this.getId();var hb=this.RL(true);var y=this.RL(true).pQ(0).P5();var fc=hb.pQ(0);fc.setAttributes("id=\""+rb+"_head\" class=\"jsx30matrix_head\"");var tc=fc.pQ(0);var jb=tc.pQ(0);jb.setAttributes("cellspacing=\"0\" cellpadding=\"0\" class=\"jsx30matrix_head_table\"");var bb=jb.pQ(0);var z=[];var Mc=this.Mv();var T=this.pi();for(var Ab=0;Ab<T.length;Ab++){T[Ab].J1({parentwidth:Mc[Ab],parentheight:y},null,true);z.push(T[Ab].paint());}var Zb=fc.paint().join(tc.paint().join(jb.paint().join(bb.paint().join(z.join("")))+this.Zd(T)));return Zb;};f.repaintHead=function(){var Fb=this.getDocument();var _=Fb.getElementById(this.getId()+"_head");if(_){var Dc=this.az();jsx3.html.setOuterHTML(_,Dc);}};f.Ik=function(m,s){var Bb=this.getServer().getJSXById(s.id);var uc=Bb.getDisplayIndex();this.xA(uc);if(m.leftButton()&&uc>=this.getFixedColumnIndex(0)&&this.getCanReorder()!=jsx3.Boolean.FALSE){rc.publish(m);var Xb=s.cloneNode(true);var xb="<table id=\""+this.getId()+"_ghost\" cellspacing=\"0\" cellpadding=\"0\" class=\"jsx30matrix_ghost\" style=\"width:"+parseInt(s.offsetWidth)+"px;\"><tr>"+jsx3.html.getOuterHTML(Xb)+"</tr></table>";var F=this.getRendered(m).childNodes[0].childNodes[0];jsx3.html.insertAdjacentHTML(F,"BeforeEnd",xb);var _b=F.lastChild;var nc=this.Mv();var v=0;for(var kb=0;kb<this.em();kb++)v=v+nc[kb];_b.style.left=v+"px";this._jsxWt=v;ic.DM(m,_b,function(q,p){return [q,0];});rc.subscribe(rc.MOUSEUP,this,"qk");}else{if(m.rightButton()){var Hc=Bb.getMenu();if(Hc){var E=Bb.getServer().getJSX(Hc);if(E!=null){var I={objEVENT:m,objMENU:E};var z=Bb.doEvent(ic.MENU,I);if(z!==false){if(z instanceof Object&&z.objMENU instanceof jsx3.gui.Menu)E=z.objMENU;E.showContextMenu(m,Bb);}}}}}};f.qk=function(l){jsx3.EventHelp.reset();rc.unsubscribe(rc.MOUSEUP,this,"qk");var yb=this.getRendered(l.event).childNodes[0].childNodes[0].lastChild;var cb=parseInt(yb.style.left);yb.parentNode.removeChild(yb);var oc=this.getChildren();var lc=this.pi();var Cc=lc[this.em()];var C=oc.indexOf(Cc);if(cb==this._jsxWt){if(this.getCanSort()!=jsx3.Boolean.FALSE)this.UG(l);}else{if(this.getCanReorder()!=jsx3.Boolean.FALSE){var Ib=this.Mv();var y=0;for(var x=0;x<lc.length;x++){if(y>=cb){var Ec=lc[x];var nb=oc.indexOf(Ec);this.Mk(l,Cc,Ec);return;}y=y+Ib[x];}this.Mk(l,Cc,lc[lc.length-1]);}}};f.Rp=function(a){return a.getSortPath();};f._s=function(h){return h.getSortDataType();};f.UG=function(n){var Gc=this.pi();var nb=Gc[this.em()];if(nb&&nb.getCanSort()!=jsx3.Boolean.FALSE&&this.getCanSort()!=jsx3.Boolean.FALSE){this.RF();var lc=this.getChildren().indexOf(nb);var pc=this.Rp(nb);var Sb=this._s(nb);var Kc=this.doEvent(ic.BEFORE_SORT,{objEVENT:n,objCOLUMN:nb,strSORTPATH:pc,strSORTTYPE:Sb});if(Kc!==false){if(Kc!=null&&typeof(Kc)=="object"){if(Kc.objCOLUMN!=null){nb=Kc.objCOLUMN;pc=this.Rp(nb);Sb=this._s(nb);}}this.setSortPath(pc);this.setSortType(Sb);this.doSort();this.doEvent(ic.AFTER_SORT,{objEVENT:n,objCOLUMN:nb,strSORTPATH:pc,strSORTTYPE:Sb});}}};f.doSort=function(s){if(s){this.setSortDirection(s);}else{this.setSortDirection(this.getSortDirection()==b.SORT_ASCENDING?b.SORT_DESCENDING:b.SORT_ASCENDING);}var Ic=this.getSortPath();var Cb=this.pi();for(var Zb=0;Zb<Cb.length;Zb++)Cb[Zb]._applySortIcon(Cb[Zb].getSortPath()==Ic);delete this._jsxUE;this.repaintData();};f.getSortPath=function(){return this.jsxsortpath==null?"":this.jsxsortpath;};f.setSortPath=function(d){this.jsxsortpath=d;};f.getSortType=function(){return this.jsxsorttype==null?jsx3.gui.Matrix.Column.TYPE_TEXT:this.jsxsorttype;};f.setSortType=function(l){this.jsxsorttype=l;};f.getSortDirection=function(){return this.jsxsortdirection==null?b.SORT_ASCENDING:this.jsxsortdirection;};f.setSortDirection=function(d){this.jsxsortdirection=d;};f.getCanSort=function(){return this.jsxsort;};f.setCanSort=function(j){this.jsxsort=j;};f.Mk=function(a,q,j){var v=this.pi().indexOf(q);var Fb=this.pi().indexOf(j);var rb=this.getFixedColumnIndex(0);if(v<=rb)return;if(Fb<rb)j=this.pi()[rb];if(!j)return;var Jc=this.insertBefore(q,j,true);if(Jc){var Ob=q.getChildIndex();this.doEvent(ic.AFTER_REORDER,{objEVENT:a,intOLDINDEX:v,intNEWINDEX:Ob});}};f.adoptChild=function(p,i,e){this.jsxsuper(p,false,e);this.Wc();if(i!==false)this.repaint();};f.insertBefore=function(p,s,k){var N=this.jsxsuper(p,s,false);if(N){this.Wc();if(k!=false)this.repaint();}return N;};f.getCanReorder=function(){return this.jsxreorder;};f.setCanReorder=function(g){this.jsxreorder=g;};f.focusRowById=function(h){var kb=this.NF(h,0);if(kb)kb.focus();};f.focusCellById=function(l,p){var qb=this.gv(l,p);if(qb)qb.focus();};f.focusCellByIndex=function(e,d){var F=this.NF(e,d);if(F)F.focus();};f.Dz=function(i,d){this.Qt(i,d);this._scrollIntoView(d);};f.km=function(q,o){};f.getFocusStyle=function(p){return this.jsxfocusstyle?this.jsxfocusstyle:p?p:null;};f.setFocusStyle=function(s){delete this._jsxah;this.jsxfocusstyle=s;};f.Fe=function(m,i){if(typeof(this._jsxah)!="object")this._jsxah=this.ll(this.getFocusStyle(b.FOCUS_STYLE));this.zd(m,this._jsxah,i);};f.ll=function(h){var u=/(-\S)/gi;var Cb={};var _b=h.split(";");for(var Ib=0;Ib<_b.length;Ib++){var Bc=_b[Ib]+"";var nc=Bc.split(":");if(nc&&nc.length==2){var jc=nc[0].replace(u,function(a,s){return s.substring(1).toUpperCase();});Cb[jc]=nc[1];}}return Cb;};f.zd=function(j,m,i){if(i){for(var ub in m)j.style[ub]=m[ub];}else{for(var ub in m)j.style[ub]="";}};f.vq=function(){return this._jsxQd;};f.OE=function(k){if(this._jsxQd!=k){var ec=this.bt();if(ec)this.Fe(ec,false);}this._jsxQd=k;};f.resetFocusContext=function(l){this.OE();};f.bt=function(){return this.getDocument().getElementById(this.vq());};f.Qt=function(j,c){this.Jj(j);var Y=true;var fc=this.pi();var bb=fc[c.cellIndex];var Yb=bb.getEditMasks();for(var x=0;x<Yb.length;x++){var Gb=Yb[x];if(this.rj(Gb,bb)){if(Gb.emGetType()!=b.EditMask.NORMAL){Y=false;break;}}}if(Y)c.focus();this.OE(c.id);this.Fe(c,true);this.Ap(j,c);};f.LH=function(p,i){this.Oy(p);};f.Oy=function(m,a){if(a==null)a=this.getSelectedIds();for(var Hc=0;Hc<a.length;Hc++){var G=a[Hc];var sc=this.getRecordNode(G);if(sc.getAttribute(bc.ATTR_UNSELECTABLE)=="1")continue;this.eval(sc.getAttribute("jsxexecute"),{strRECORDID:G});}if(a.length)this.doEvent(ic.EXECUTE,{objEVENT:m,strRECORDID:a[0],strRECORDIDS:a});};f.executeRecord=function(r){var N=this.getRecordNode(r);if(N)this.eval(N.getAttribute("jsxexecute"),{strRECORDID:r});};f.Ap=function(e,h){var nc=this.getSelectionModel(b.SELECTION_ROW);var Lc=this.nf(h);var jc=Lc.cell;var Dc=jc?jc.cellIndex:null;var mb=Lc.row;var Nc=mb.getAttribute("jsxid");var Eb=this.Lh()&&this.Lm(mb);if(!Eb){if(this.HC().ctrl){this.rv(Nc);if(this.isRecordSelected(Nc)){this.Ez(e,Nc,null);}else{this.zf(e,Nc,mb,true,Dc);}}else{if(this.HC().shift){var Jb=this.aw();if(Jb){var Fb=this.ae(Jb);if(Fb)this.iC(e,Fb,mb,Dc);}else{this.rv(Nc);this.zf(e,Nc,null,false,Dc);}}else{this.rv(Nc);if(!this.isRecordSelected(Nc))this.zf(e,Nc,null,false,Dc);}}}this.OB(e,jc,this.pi()[Dc],Eb);delete this._jsxLn;};f.Il=function(){if(!this._jsxng)this._jsxng={bg:this.getServer().resolveURI(this.getSelectionBG(b.SELECTION_BG))};return this._jsxng.bg;};f.getSelectionBG=function(k){return this.jsxselectionbg?this.jsxselectionbg:k?k:null;};f.setSelectionBG=function(o){delete this._jsxng;this.jsxselectionbg=o;};f.rv=function(i){this._jsxzq=i;};f.aw=function(){return this._jsxzq;};f.LG=function(){return this.getDocument().getElementById(this.aw());};f.xr=function(s,o,d){d.push(s);var ub=s.getParent();return !ub.equals(o)?this.xr(ub,o,d):d;};f.getSelectedNodes=function(){return this.getXML().selectNodes("//record[@"+bc.ATTR_SELECTED+"='1']");};f.getSelectedIds=function(){var nb=this.getSelectedNodes();var dc=nb.getLength();var Jc=new Array(dc);for(var Q=0;Q<dc;Q++){Jc[Q]=nb.getItem(Q).getAttribute("jsxid");}return Jc;};f.g5=function(k){var I=this.getRecord(k);return I&&(I[bc.ATTR_UNSELECTABLE]==null||I[bc.ATTR_UNSELECTABLE]!="1");};f.isRecordSelected=function(l){var u=this.getRecord(l);return u!=null&&u[bc.ATTR_SELECTED]=="1";};f.selectRecord=function(e){if(this.getSelectionModel()==b.SELECTION_UNSELECTABLE)return;if(!this.g5(e))return;this.zf(false,e,null,this.getSelectionModel()==b.SELECTION_MULTI_ROW);};f.deselectRecord=function(r){this.Ez(false,r,null);};f.deselectAllRecords=function(){var V=this.getSelectedIds();var gc=V.length;for(var Lb=0;Lb<gc;Lb++)this.Ez(false,V[Lb]);};f.zf=function(l,n,h,m,s){var Jc=this.getSelectionModel(b.SELECTION_ROW);var Tb=this.getRecordNode(n);var I=m||l&&this.getCanDrag()==1;if(Jc==b.SELECTION_UNSELECTABLE||!Tb||Tb.getAttribute(bc.ATTR_SELECTED)=="1"&&I||Tb.getAttribute(bc.ATTR_UNSELECTABLE)=="1")return false;var Dc=m&&Jc==b.SELECTION_MULTI_ROW;if(!Dc)this.deselectAllRecords();Tb.setAttribute(bc.ATTR_SELECTED,"1");h=h||this.ae(n);if(h!=null){var E="url("+this.Il()+")";for(var ac=0;ac<h.childNodes.length;ac++)h.childNodes[ac].style.backgroundImage=E;}this.On(l,n,s);return true;};f.Ez=function(o,e,k){var Nb=this.getRecordNode(e);if(!Nb||Nb.getAttribute(bc.ATTR_SELECTED)!="1")return false;Nb.removeAttribute(bc.ATTR_SELECTED);k=k||this.ae(e);if(k!=null&&k.childNodes){k.style.backgroundImage="";for(var uc=0;uc<k.childNodes.length;uc++)k.childNodes[uc].style.backgroundImage="";}this.On(o);return true;};f.xz=function(l){if(l.rowIndex!=null&&!isNaN(l.rowIndex)&&l.rowIndex>-1)return l.rowIndex;var G=l.parentNode;if(G){var Eb=G.childNodes.length;for(var oc=0;oc<Eb;oc++){if(G.childNodes[oc]==l)return oc;}}return -1;};f.iC=function(p,g,o,q){if(!g||!o)return;var Q=g.getAttribute("jsxid");var Rb=o.getAttribute("jsxid");if(!this.g5(Q)||!this.g5(Rb))return;var Ic=this.xz(g);var x=this.xz(o);var eb=Math.min(Ic,x);var hb=Math.max(Ic,x);var Bc=this.getSelectedIds();var Bb=Bc.length;var Kb={};if(this.getRenderingModel()!="hierarchical"){var Ec=false;var t=this.getPagingModel(b.PAGING_OFF);if(t==b.PAGING_CHUNKED){var cc=g.parentNode;var M=o.parentNode;var P=false;if(cc.tagName.toLowerCase()!="table"){P=true;cc=cc.parentNode;M=M.parentNode;}if(cc!=M){for(var Xb=0;Xb<Bb;Xb++)this.Ez(false,Bc[Xb],this.ae(Bc[Xb]));var Kc=cc.parentNode;var Jb={};for(var Xb=0;Xb<Kc.childNodes.length;Xb++){if(cc==Kc.childNodes[Xb])Jb.anchor=Xb;else{if(M==Kc.childNodes[Xb])Jb.target=Xb;}}if(Jb.anchor<Jb.target){var Ac=Jb.anchor;var I=Jb.target;eb=Ic;hb=x;}else{var Ac=Jb.target;var I=Jb.anchor;eb=x;hb=Ic;}var gb=this.getRowsPerPanel(b.DEFAULT_ROWS_PER_PANEL);for(var qb=Ac;qb<=I;qb++){var Nc=Kc.childNodes[qb];var Lb=qb==Ac?eb:0;var N=qb==I?hb:gb-1;var qc=P?Nc.childNodes[0]:Nc;for(var Xb=Lb;Xb<=N;Xb++){var vc=qc.childNodes[Xb].getAttribute("jsxid");this.zf(false,vc,qc.childNodes[Xb],true,q);}}}else{Ec=true;}}if(Ec||t==b.PAGING_OFF||t==b.PAGING_2PASS){for(var Xb=0;Xb<Bb;Xb++){var Ab=this.ae(Bc[Xb]);if(Ec||this.xz(Ab)<eb||this.xz(Ab)>hb){this.Ez(false,Bc[Xb],Ab);}else{Kb[Bc[Xb]]=1;}}var qc=g.parentNode;for(var Xb=eb;Xb<=hb;Xb++){var vc=qc.childNodes[Xb].getAttribute("jsxid");if(!Kb[vc])this.zf(false,vc,qc.childNodes[Xb],true,q);}}}else{for(var Xb=0;Xb<Bb;Xb++)this.Ez(false,Bc[Xb],this.ae(Bc[Xb]));var Vb=this.getRecordNode(this.getRenderingContext("jsxroot"));var K=this.getRecordNode(Q);var C=this.getRecordNode(Rb);var U=jsx3.util.List.wrap(this.xr(K,Vb,[]));var z=jsx3.util.List.wrap(this.xr(C,Vb,[]));var H=U.filter(function(j){for(var Xb=0;Xb<z.size();Xb++){if(j.equals(z.get(Xb)))return true;}return false;});var Qb=H.get(0);if(!Qb){var Jc=this.hg(this.cF());}else{var Jc=this.ae(Qb.getAttribute("jsxid"));}var Hc=[];var wc=0;while(Jc&&wc<2){if(Jc==g)wc++;if(Jc==o)wc++;if(wc)Hc.push(Jc);Jc=wc<2?this.Nu("S",Jc):null;}for(var Xb=0;Xb<Hc.length;Xb++){var vc=Hc[Xb].getAttribute("jsxid");this.zf(false,vc,Hc[Xb],true,q);}}this.On(p,Rb,q);};f.On=function(q,r,k){if(q&&q instanceof rc){this.doEvent(ic.SELECT,{objEVENT:q,strRECORDID:r,strRECORDIDS:this.getSelectedIds(),objCOLUMN:k!=null?this.pi()[k]:null});this.doEvent(ic.CHANGE,{objEVENT:q});}};f.OB=function(k,g,r,e){var N=r.getEditMask();if(N!=null){if(e){var J=this.qs();var Eb=J[r.getPath()];if(!Eb)Eb="";var Hb="jsxautorow";}else{var Hb=g.parentNode.getAttribute("jsxid");var Eb=r.getValueForRecord(Hb);if(Eb==null)Eb="";}var Hc=this.getRendered(g);var wc=this.pl();var xc=N.emGetType()==b.EditMask.NORMAL||N.emGetType()==b.EditMask.DIALOG;if(xc){var Lc=this.doEvent(ic.BEFORE_EDIT,{objEVENT:k,strRECORDID:Hb,objCOLUMN:r});if(Lc===false)return;if(Lc!=null&&typeof(Lc)=="object"){if(typeof(Lc.objMASK)!="undefined")N=Lc.objMASK;}}var H=jsx3.html.getRelativePosition(wc,g);var Cb=jsx3.html.getRelativePosition(Hc,Hc);Cb.W-=parseInt(wc.style.left);Cb.H-=parseInt(wc.style.top);var x=this._jsxHk;if(x&&x.mask&&x.mask.emGetSession())this.endEditSession();if(N.Dp(Eb,H,Cb,this,r,Hb,g)){this._jsxHk={mask:N,column:r,recordId:Hb,value:Eb};rc.subscribeLoseFocus(this,this.getRendered(g).childNodes[1],"uo");}}};f.getAutoRowSession=function(){return this.qs();};f.qs=function(){if(!this._jsxwF){this._jsxwF={jsxid:jsx3.xml.CDF.getKey()};this._jsxhq={jsxid:this._jsxwF.jsxid};}return this._jsxwF;};f.gg=function(){if(this._jsxwF){for(var gc in this._jsxwF){if(this._jsxhq[gc]!=this._jsxwF[gc])return true;}}return false;};f._h=function(d){var Y=this.qs();Y[d.column.getPath()]=d.newvalue;};f.RB=function(d,m){if(m!==false)this.Jj(d);var kc=this.qs();if(kc!=null){delete this._jsxwF;var tb;if(d)tb=this.doEvent(ic.BEFORE_APPEND,{objEVENT:d,objRECORD:kc});if(tb!==false){var yc=this.insertRecord(kc,null,true);if(d)this.doEvent(ic.AFTER_APPEND,{objEVENT:d,objRECORDNODE:yc});}var G={jsxid:"jsxautorow"};this.insertRecord(G,null,false);this.redrawRecord("jsxautorow",jsx3.xml.CDF.UPDATE);this.deleteRecord("jsxautorow",false);}};f.commitAutoRowSession=function(r,s){this.RB(r,false);if(!isNaN(s)){var z=this.ae("jsxautorow");if(z&&z.childNodes[+s])z.childNodes[+s].focus();}};f.ct=function(){delete this._jsxwF;};f.Lm=function(c){if(!c)return false;if(c.getAttribute("jsxid")!="jsxautorow")return false;var U=c.parentNode;if(U.tagName.toLowerCase()!="table")U=U.parentNode;return U.getAttribute("jsxautorow")=="true";};f.Jj=function(a,k){var _b=this._jsxHk;if(_b!=null){if(!k){delete this._jsxHk;rc.unsubscribeLoseFocus(this);}var G=k?_b.mask.emGetValue():_b.mask.Up();var nc=_b.recordId=="jsxautorow"&&this.Lh()&&this.Lm(this.ae("jsxautorow"));var Hc=true;if(a&&nc){var fb=this.ae("jsxautorow");Hc=jsx3.html.findElementUp(a.srcElement(),function(m){return m==fb;},true)==null;}if(!(Hc&&nc&&this.gg())){if(_b.value===G||_b.value==null&&G.trim()==""||(_b.value+"").trim()==""&&G==null)return;}var S=_b.mask.emGetType()==b.EditMask.NORMAL||_b.mask.emGetType()==b.EditMask.DIALOG;var hc=true;if(S){if(a!=null)hc=this.doEvent(ic.AFTER_EDIT,{objEVENT:a,strRECORDID:_b.recordId,objCOLUMN:_b.column,strNEWVALUE:G});if(hc!=null&&typeof(hc)=="object"){if(typeof(hc.strNEWVALUE)!="undefined")G=hc.strNEWVALUE;}if(hc!==false){if(k)_b.value=G;if(nc){_b.newvalue=G;this._h(_b);var I=this.qs();var K={};for(var Yb in I)K[Yb]=I[Yb];K.jsxid="jsxautorow";this.insertRecord(K,null,false);this.redrawCell("jsxautorow",_b.column);this.deleteRecord("jsxautorow",false);if(Hc&&!k&&this.gg())this.RB(a,false);}else{if(_b.column.getPath()=="jsxid"){this.insertRecordProperty(_b.recordId,"jsxid",G,false);this.redrawCell(G,_b.column);}else{_b.column.setValueForRecord(_b.recordId,G);this.redrawCell(_b.recordId,_b.column);}}}}if(a!=null&&hc!==false)this.doEvent(ic.AFTER_COMMIT,{objEVENT:a,strRECORDID:_b.recordId,objCOLUMN:_b.column,strVALUE:G});}};f.endEditSession=function(o){this.Jj(o);};f.collapseEditSession=function(l,a){var F=this._jsxHk;if(F!=null){F.mask.emCollapseEdit(l);this.endEditSession(l);a.focus();}};f.uo=function(c){var ec=c.event.srcElement();var cc=this._jsxHk;if(cc&&!cc.GF&&!cc.mask.containsHtmlElement(ec)){this.Jj(c.event);}};f.rj=function(e,h){if(e._jsxod)return true;if(e.instanceOf(jsx3.gui.Form)){b.EditMask.jsxclass.mixin(e,true);}else{if(jsx3.gui.Dialog&&e instanceof jsx3.gui.Dialog){b.DialogMask.jsxclass.mixin(e,true);b.BlockMask.jsxclass.mixin(e,true);b.EditMask.jsxclass.mixin(e,true);}else{if(e instanceof w){b.BlockMask.jsxclass.mixin(e,true);b.EditMask.jsxclass.mixin(e,true);}else{return false;}}}e.emInit(h);e._jsxod=true;return true;};f.IU=function(d,i){var O=d.srcElement();var _b=this.nf(O);var vb=O.getAttribute("jsxtype");if(vb=="plusminus"||vb=="paged"){this.QF(d,O);}else{while(O&&O!=i){if(O.getAttribute("jsxtype")=="record"){if(!jsx3.gui.isMouseEventModKey(d)&&!d.shiftKey()){var V=_b.row.getAttribute("jsxid");var xb=this.getSelectedIds();var Mc=xb.length==1&&V==xb[0]?false:d;this.deselectAllRecords();this.zf(Mc,V,_b.row,false,_b.cell?_b.cell.cellIndex:null);return;}}O=O.parentNode;}}};f.QF=function(l,a,s){var xb=this.SE(a);var cc=this.hg(xb.previousSibling).getAttribute("jsxid");var u=this.getRecordNode(cc);if(u.selectNodes("record").getLength()==0)return;if(s==null)s=false;if(a.nodeType==3)a=a.parentNode;var Pb=a.getAttribute("jsxtype");if(xb.style.display=="none"){s=true;u.setAttribute("jsxopen","1");xb.style.display="";if(this.getRenderNavigators(1)!=0)a.style.backgroundImage="url("+this.getUriResolver().resolveURI(this.getIconMinus(b.ICON_MINUS))+")";if(this._j(xb)){X.trace("Fetch the content belonging to: "+cc);var mc={};mc.jsx_panel_css="position:relative;";mc.jsx_column_widths=this.zF();mc.jsx_rendering_context=cc;mc.jsx_context_index=xb.getAttribute("jsxcontextindex");xb.innerHTML=this.doTransform(mc);if(this.getRenderNavigators(1)!=0)a.setAttribute("jsxtype","plusminus");var zb={painted:1,token:b.getToken(),contextnodes:xb.childNodes};this.Zt()[0]=zb;this.an(zb);}}else{u.removeAttribute("jsxopen");xb.style.display="none";if(this.getRenderNavigators(1)!=0)a.style.backgroundImage="url("+this.getUriResolver().resolveURI(this.getIconMinus(b.ICON_PLUS))+")";}this._p();if(l)this.doEvent(ic.TOGGLE,{objEVENT:l,strRECORDID:cc,objRECORD:u,bOPEN:s});};f.toggleItem=function(o,r){var Qb=this.NF(o,0);if(Qb!=null){while(Qb&&Qb.getAttribute&&Qb.getAttribute("jsxtype")!="plusminus"&&Qb.getAttribute("jsxtype")!="paged")Qb=Qb.childNodes[0];this.QF(false,Qb,r);}};f.SE=function(j){while(!j.tagName||j&&j.tagName&&j.tagName.toLowerCase()!="table"||j.id=="")j=j.parentNode;return j.nextSibling;};f.getDragIcon=function(q,a,i,d){var db=jsx3.EventHelp.DRAGIDS;var _="";var Nb=q.id;var ac=0.4;var wb=q.getAttribute("jsxid");if(a.g5(wb)&&db.indexOf(wb)==-1)db.push(wb);for(var uc=0;uc<db.length&&uc<4;uc++){var sb=a.ae(db[uc]);if(sb)_=_+a.Ip(sb,ac);ac=ac-0.1;}return _;};f.Ip=function(l,g){var Nc=l;while(Nc.tagName.toLowerCase()!="table")Nc=Nc.parentNode;var Wb=Nc.cloneNode(false);var wb=l.cloneNode(true);Wb.appendChild(wb);Wb.style.width="300px";wb.id="";Wb.id="";return "<div id='JSX' class='jsx30matrix_dragicon' style='"+jsx3.html.getCSSOpacity(g)+"'>"+jsx3.html.getOuterHTML(Wb)+"</div>";};f.mL=function(s,m){this.gn(s);if(s.leftButton()){var Lb=s.srcElement();var S=this.nf(Lb);if(S==null)return;if(S){m=S.cell;if(this.vq()!=m.id){m.focus();}else{this.TE();this.Qt(s,m);}if(this.getCanDrag()==1&&this.getSelectionModel(b.SELECTION_ROW)>b.SELECTION_UNSELECTABLE){var Mc=this.getSelectedIds();var Fc=S.row.getAttribute("jsxid");var Hc=jsx3.util.List.wrap(Mc);if(Hc.indexOf(Fc)==-1)Mc=[Fc];if(this.g5(Fc)&&Mc.indexOf(Fc)==-1)Mc.push(Fc);this.doDrag(s,S.row,this.getDragIcon,{strDRAGIDS:Mc});}}}rc.publish(s);s.cancelAll();};f.CL=function(h,e){var G=h.toElement();if(!G)return;var vb=G.getAttribute("jsxtype");var hc=this.nf(G);if(!hc)return;var Hb=hc.row.getAttribute("jsxid");e=this.ck(hc.row);if(jsx3.EventHelp.isDragging()&&this.getCanDrop()==1&&jsx3.EventHelp.getDragIds()[0]!=null){if(vb=="plusminus"||vb=="paged"){var hb=this;h._0();b.TOGGLETIMEOUT=window.setTimeout(function(){if(hb.getParent()!=null){hb.QF(h,G);}},b.cv);}var pc=this.doEvent(ic.BEFORE_DROP,{objEVENT:h,strRECORDID:Hb,objSOURCE:jsx3.EventHelp.getDragSource(),strDRAGIDS:jsx3.EventHelp.getDragIds(),strDRAGTYPE:jsx3.EventHelp.getDragType(),objGUI:e});if(!(pc===false)){var tb=this.getRendered(h);var C=this.getAbsolutePosition(tb,hc.row);var kc=this.uC(tb);var ob=this.getRenderingModel()=="hierarchical"&&this.getRenderNavigators(1)!=0?parseInt(hc.row.childNodes[0].childNodes[0].childNodes[0].style.left):4;if(this.getRenderingModel()!="hierarchical"||C.H/3>h.getOffsetY()){kc.style.top=C.T-4+"px";kc.style.width=this.Ji()-ob-8+"px";kc.style.height="7px";kc.style.backgroundImage="url("+b.INSERT_BEFORE_IMG+")";kc.setAttribute("dropverb","insertbefore");}else{ob=ob+26;kc.style.width="12px";kc.style.height="12px";kc.style.top=C.T-10+C.H+"px";kc.style.backgroundImage="url("+b.APPEND_IMG+")";kc.setAttribute("dropverb","append");}kc.style.left=ob+"px";kc.setAttribute("rowcontext",Hb);kc.style.display="block";}}else{if(this.getEvent(ic.SPYGLASS)){this.applySpyStyle(G);var R=h.clientX()+jsx3.EventHelp.DEFAULTSPYLEFTOFFSET;var Z=h.clientY()+jsx3.EventHelp.DEFAULTSPYTOPOFFSET;h._0();var hb=this;var qb=this.pi()[hc.cell.cellIndex];if(b.SPYTIMEOUT)window.clearTimeout(b.SPYTIMEOUT);b.SPYTIMEOUT=window.setTimeout(function(){b.SPYTIMEOUT=null;if(hb.getParent()!=null)hb.Zx(h,R,Z,Hb,qb,G);},jsx3.EventHelp.SPYDELAY);}}};f.Zx=function(c,p,l,d,j,i){this.removeSpyStyle(i);var cb=this.doEvent(ic.SPYGLASS,{objEVENT:c,objCOLUMN:j,strRECORDID:d});if(cb){ic.hideSpy();this.showSpy(cb,p,l);}};f.Tr=function(s,m){this.xk(m.parentNode);if(jsx3.EventHelp.isDragging()&&this.getCanDrop()==1&&jsx3.EventHelp.getDragIds()[0]!=null){var gb=this;this._jsxXC={offsety:s.getOffsetY(),offsetheight:m.offsetHeight,scrollheight:m.scrollHeight};this._jsxXC.interval=window.setInterval(function(){gb.rs();},b.AUTO_SCROLL_INTERVAL);}};f.rs=function(){if(this._jsxXC.offsety<this._jsxXC.offsetheight/2){if(this.getScrollTop()>0)this.setScrollTop(this.getScrollTop()-20);}else{if(this.getScrollTop()<this._jsxXC.scrollheight)this.setScrollTop(this.getScrollTop()+20);}};f.Yn=function(n,r){if(this._jsxXC){window.clearInterval(this._jsxXC.interval);delete this._jsxXC;}};f.lt=function(q,o){if(jsx3.EventHelp.isDragging()&&this.getCanDrop()==1&&jsx3.EventHelp.getDragIds()[0]!=null&&this._jsxXC){this._jsxXC.offsety=q.getOffsetY();this._jsxXC.offsetheight=o.offsetHeight;this._jsxXC.scrollheight=o.scrollHeight;}};f._ebMouseOutDropIcon=function(p,i){if(!p.isFakeOut(i.parentNode.childNodes[1])){this.xk(i.parentNode);}};f.u2=function(a,l){var lc=a.fromElement();if(a.isFakeOut(l))this.xk(l.parentNode);if(!jsx3.EventHelp.isDragging()&&this.getEvent(ic.SPYGLASS)){var Kb=a.toElement();var yb=false;try{yb=!Kb||Kb.className!="jsx30spyglassbuffer";}catch(Kc){yb=true;}if(yb){jsx3.sleep(ic.hideSpy);this.removeSpyStyle(lc);if(b.SPYTIMEOUT)window.clearTimeout(b.SPYTIMEOUT);}}if(lc==null||a.isFakeOut(l.parentNode)&&lc.getAttribute("jsxtype")!="plusminus")return;var _b=lc.getAttribute("jsxtype");var Fb=this.nf(lc);if(!Fb)return;var mb=Fb.row.getAttribute("jsxid");l=this.ck(Fb.row);if(jsx3.EventHelp.isDragging()&&this.getCanDrop()==1){if(_b=="plusminus")window.clearTimeout(b.TOGGLETIMEOUT);var t=this.doEvent(ic.CANCEL_DROP,{objEVENT:a,strRECORDID:mb,objSOURCE:jsx3.EventHelp.getDragSource(),strDRAGIDS:jsx3.EventHelp.getDragIds(),strDRAGTYPE:jsx3.EventHelp.getDragType(),objGUI:l});this.xk(this.getRendered(a));}};f.nf=function(a){if(a.getAttribute("jsxtype")=="record")return {row:a,cell:null};while(a.parentNode.getAttribute("jsxtype")!="record"){a=a.parentNode;if(a.tagName.toLowerCase()=="body"||a.id==this.getId())return null;}return {row:a.parentNode,cell:a};};f.ck=function(n){if(this.getRenderingModel()=="hierachical"){n=this.SE(n).parentNode;}else{if(this.getPagingModel(b.PAGING_OFF)!=b.PAGING_PAGED){while(n.tagName.toLowerCase()!="table")n=n.parentNode;}}return n;};f._4=function(d,i){};f._isDescendantOrSelf=function(h,g){while(h&&g){if(h.equals(g))return true;h=h.getParent();}return false;};f._onMouseUp=function(p,i){var Fb=p.srcElement()&&p.srcElement().className=="jsx30matrix_drop_icon"?this.ae(p.srcElement().getAttribute("rowcontext")).childNodes[0]:p.srcElement();var N=this.nf(Fb);if(this.getCanDrop()==1&&jsx3.EventHelp.isDragging()){if(jsx3.EventHelp.getDragType()=="JSX_GENERIC"){jsx3.sleep(function(){this.xk();},null,this);Fb=jsx3.EventHelp.getDragSource();if(Fb&&Fb.instanceOf(jsx3.xml.CDF)){var Gb=jsx3.gui.isMouseEventModKey(p);var qb=Fb.doEvent(ic.ADOPT,{objEVENT:p,strRECORDID:jsx3.EventHelp.getDragId(),strRECORDIDS:jsx3.EventHelp.getDragIds(),objTARGET:this,bCONTROL:Gb});var Xb={objEVENT:p,objSOURCE:Fb,strDRAGIDS:jsx3.EventHelp.getDragIds(),strDRAGTYPE:jsx3.EventHelp.getDragType(),strDRAGID:jsx3.EventHelp.getDragId(),strRECORDID:N?N.row.getAttribute("jsxid"):null,objCOLUMN:N!=null?this.pi()[N.cell.cellIndex]:null,bALLOWADOPT:qb!==false};var Sb=this.doEvent(Gb?ic.CTRL_DROP:ic.DROP,Xb);if(qb!==false&&Sb!==false){var cc=this.uC(this.getRendered(p));var hc=cc.getAttribute("dropverb");var rb=jsx3.EventHelp.getDragIds();for(var Jc=0;Jc<rb.length;Jc++){if(!(this==Fb&&N&&this._isDescendantOrSelf(this.getRecordNode(N.row.getAttribute("jsxid")),this.getRecordNode(rb[Jc])))){Fb.deleteRecordProperty(rb[Jc],"jsxselected",false);var yb;if(hc=="insertbefore"){yb=true;var Jb=this.adoptRecordBefore(Fb,rb[Jc],N?N.row.getAttribute("jsxid"):null);}else{yb=N!=null;var Jb=this.adoptRecord(Fb,rb[Jc],this.getRenderingModel()=="hierarchical"&&N?N.row.getAttribute("jsxid"):null,N!=null);}if(Jb&&Fb.getRenderingModel()!="hierarchical"){var vb=Jb.selectNodes(".//record");for(var gb=vb.getLength()-1;gb>=0;gb--){Fb.redrawRecord(vb.getItem(gb).getAttribute("jsxid"),bc.DELETE);if(yb)this.redrawRecord(vb.getItem(gb).getAttribute("jsxid"),bc.INSERT);}}}}if(!yb&&!N)this.repaint();}}}jsx3.EventHelp.reset();}else{if(p.rightButton()){var Lc=this.getMenu();if(Lc){var Zb=this.getServer().getJSX(Lc);if(Zb!=null){var v,K;if(N){v=this.pi()[N.cell.cellIndex];K=N.row.getAttribute("jsxid");}var Dc={objEVENT:p,objMENU:Zb,strRECORDID:K,objCOLUMN:v};var Vb=this.doEvent(ic.MENU,Dc);if(Vb!==false){if(Vb instanceof Object&&Vb.objMENU instanceof jsx3.gui.Menu)Zb=Vb.objMENU;Zb.showContextMenu(p,this,K);}}}}}};f.gn=function(h){this._jsxLn={ctrl:jsx3.gui.isMouseEventModKey(h),shift:h.shiftKey(),alt:h.altKey()};};f.HC=function(){return this._jsxLn!=null?this._jsxLn:{};};f.DY=function(p,i){if(this.jsxsupermix(p,i))return;var Mc=p.keyCode();var J=p.hasModifier(true);var U=Mc==rc.KEY_TAB&&!J;var sc=this.getSelectionModel(b.SELECTION_ROW);this.gn(p);if(this.vq()==null){var hb=this.VE();if(hb){this.OE(hb.id);}else{return;}}var R=this.bt();var ub=this.Lh()&&R&&this.Lm(R.parentNode);if(ub&&(Mc==rc.KEY_ENTER||Mc==rc.KEY_ARROW_DOWN||Mc==rc.KEY_ARROW_UP||R.parentNode.lastChild==R&&(U&&!p.shiftKey()||Mc==rc.KEY_ARROW_RIGHT)||R.parentNode.firstChild==R&&(U&&p.shiftKey()||Mc==rc.KEY_ARROW_LEFT))){var T=R.cellIndex;if(Mc==rc.KEY_ENTER){this.Jj(p);var xc=R.parentNode;if(!xc)xc=this.ae("jsxautorow");if(xc&&xc.childNodes[T])xc.childNodes[T].focus();}else{if(this.Lh()==2&&Mc==rc.KEY_ARROW_DOWN){var Q=this.cF();if(Q){var pb=this.hg(Q);if(pb)pb.childNodes[T].focus();}}else{if(this.Lh()==1&&Mc==rc.KEY_ARROW_UP){var Q=this.No();if(Q){var pb=this.LF(Q);if(pb)pb.childNodes[T].focus();}}else{if(R.parentNode.lastChild==R&&(U&&!p.shiftKey()||Mc==rc.KEY_ARROW_RIGHT)){R.parentNode.firstChild.focus();}else{if(R.parentNode.firstChild==R&&(U&&p.shiftKey()||Mc==rc.KEY_ARROW_LEFT)){R.parentNode.lastChild.focus();}}}}}V=true;}else{if(R){var T=R.cellIndex;var pc=R.parentNode.getAttribute("jsxid");var V;if(Mc==rc.KEY_ARROW_UP||Mc==rc.KEY_ENTER&&p.shiftKey()){var _b=this.Jh("N",R,true,T);V=this.gj(_b);}else{if(Mc==rc.KEY_ARROW_DOWN||Mc==rc.KEY_ENTER&&!p.shiftKey()&&sc==b.SELECTION_UNSELECTABLE){var _b=this.Jh("S",R,true,T);V=this.gj(_b);}else{if(Mc==rc.KEY_ARROW_LEFT||U&&p.shiftKey()){if(this.getRenderingModel()=="hierarchical"&&T==0&&this.getSuppressVScroller()!=1){var Jb=R.parentNode.getAttribute("jsxid");var lc=this.getRecordNode(Jb);var Lb=lc.getAttribute("jsxopen");if(Lb==1&&lc.selectSingleNode("record")){var vb=this.Qh(R);this.QF(p,vb,false);V=true;}else{var _b=this.Jh("W",R,true,T);V=this.gj(_b);}}if(!V){var _b=this.Jh("W",R,true,T);V=this.gj(_b);}}else{if(Mc==rc.KEY_ARROW_RIGHT||U&&!p.shiftKey()){if(this.getRenderingModel()=="hierarchical"&&T==0&&this.getSuppressVScroller()!=1){var Jb=R.parentNode.getAttribute("jsxid");var lc=this.getRecordNode(Jb);var Lb=lc.getAttribute("jsxopen");if(Lb!=1&&(lc.getAttribute("jsxlazy")=="1"||lc.selectSingleNode("record"))){var vb=this.Qh(R);this.QF(p,vb,true);V=true;}else{var _b=this.Jh("E",R,true,T);V=this.gj(_b);}}if(!V){var _b=this.Jh("E",R,true,T);V=this.gj(_b);}}else{if(Mc==rc.KEY_ENTER){this.Oy(p);V=true;}else{if(U&&p.shiftKey()){this.focus();V=true;}else{if(U){this.getRendered(p).lastChild.focus();V=true;}}}}}}}}}if(V)p.cancelAll();};f.gj=function(n){if(n){jsx3.sleep(function(){try{n.focus();}catch(Kc){}});return true;}};f.Qh=function(c){var eb=c.childNodes[0].childNodes[0];var ib=this.hg(eb);if(ib)return ib.childNodes[0];};f.sf=function(){return this._jsxef;};f.TE=function(k){this._jsxef=k;};f.Jh=function(m,p,a,g){var Y=this.getSelectionModel(b.SELECTION_ROW);if(m=="E"){this.TE();if(p.parentNode.lastChild!=p){return p.nextSibling;}else{if(p.parentNode.lastChild==p&&Y>b.SELECTION_UNSELECTABLE){return p.parentNode.firstChild;}else{m="S";p=p.parentNode.firstChild;g=0;}}}else{if(m=="W"){this.TE();if(p.parentNode.firstChild!=p){return p.previousSibling;}else{if(p.parentNode.firstChild==p&&Y>b.SELECTION_UNSELECTABLE){return p.parentNode.lastChild;}else{m="N";p=p.parentNode.lastChild;g=p.cellIndex;}}}}var sc=this.kD(m,p.parentNode,a);if(sc){if(this.sf()&&(m=="N"||m=="S")&&sc.childNodes.length>1){g=this.sf();this.TE();}var x=sc.childNodes[g];if(x){return x;}else{this.TE(g);return sc.childNodes[0];}}else{return null;}return sc?sc.childNodes[g]?sc.childNodes[g]:sc.childNodes[0]:null;};f.kD=function(k,h,n){if(k=="W")k="N";else{if(k=="E")k="S";}if(this.getRenderingModel()=="hierarchical")return this.Nu(k,h);if(k=="N"&&h.previousSibling&&h.previousSibling.tagName.toLowerCase()!="colgroup"){return h.previousSibling;}else{if(k=="S"&&h.nextSibling){return h.nextSibling;}else{var xc=this.jC(this.sg(h));var zc;var Rb=this.getRenderingModel()=="hierarchical"?this.Zp():this.Zt().length;if(k=="N"&&xc==0||k=="S"&&xc==Rb-1){if(k=="N"&&this.Lh()==2||k=="S"&&this.Lh()==1)return this.hg(this.no());else return null;}else{if(k=="N"&&(zc=this.zi(xc-1))!=null){var Jb=this.getRenderingModel()=="hierarchical"?1:this.getRowsPerPanel(b.DEFAULT_ROWS_PER_PANEL);return this.LF(zc);}else{if(k=="S"&&(zc=this.zi(xc+1))!=null){return this.hg(zc);}}}}}return null;};f.Nu=function(i,a){var ub=a;if(i=="N"){while(ub.tagName.toLowerCase()!="table")ub=ub.parentNode;var u=this.ie(ub.parentNode.previousSibling);if(u)return u;var Mb=ub.parentNode.parentNode.previousSibling;return this.hg(Mb);}else{if(i=="S"){while(ub.tagName.toLowerCase()!="table")ub=ub.parentNode;var Hc=ub.nextSibling;if(Hc&&Hc.style.display.toLowerCase()!="none"){var hb=Hc.childNodes[0].childNodes[0];return this.hg(hb);}Hc=ub.parentNode.nextSibling;if(Hc){var hb=Hc.childNodes[0];return this.hg(hb);}return this.ai(ub.parentNode);}}return null;};f.ie=function(a){if(a){var Y=a.childNodes[1];if(Y&&Y.style.display.toLowerCase()!="none"&&Y.childNodes.length){var y=Y.lastChild;Y=y.childNodes[1];if(Y&&Y.style.display.toLowerCase()!="none"&&Y.childNodes.length){return this.ie(y);}else{return this.hg(y.childNodes[0]);}}return this.hg(a.childNodes[0]);}return null;};f.ai=function(p){var Hb=p.parentNode.parentNode.nextSibling;if(Hb){return this.hg(Hb.childNodes[0]);}else{var Y=p.parentNode.parentNode;if(Y)return this.ai(Y);}return null;};f._scrollIntoView=function(e){var cc=jsx3.html.getRelativePosition(this.pl(),e);var fb=this.getScrollTop();var ib=cc.T;var t=parseInt(this.RL(true).pQ(1).P5()-B.getScrollSize()+1);if(!(ib>fb&&ib+cc.H<fb+(t-(B.getScrollSize()+1)))){var wb=Math.abs(ib-fb);var P=Math.abs(ib-(fb+t));if(P<wb){if(P==0)P=cc.H;this.setScrollTop(fb+P);}else{this.setScrollTop(ib-(B.getScrollSize()+1));}}if(this.getScaleWidth()!=1){var U=this.getScrollLeft();var Y=cc.L;var lb=parseInt(this.RL(true).pQ(1).XK()-B.getScrollSize()+1);if(!(Y>U&&Y+cc.W<U+(lb-(B.getScrollSize()+1)))){var Fb=Math.abs(Y-U);var oc=Math.abs(Y-(U+lb));if(oc<Fb){this.setScrollLeft(Y);}else{this.setScrollLeft(Y-(B.getScrollSize()+1));}}}};f.Zd=function(e){var cc=[];var sb=0;var Hc=this.RL().pQ(0);var Kc=Hc.P5();var tc=this.Mv();for(var ec=0;ec<e.length;ec++){var Y=e[ec].RL();sb=sb+Y.jU();var yb=this.getResizable()!=0&&ec<e.length-1&&e[ec].getResizable()!=0;if(yb){var dc=this.RX(rc.MOUSEDOWN,"Si",3)+this.RX(rc.DOUBLECLICK,"Xp",3);var Wb="";}else{var dc="";var Wb="visibility:hidden;";}cc.push("<div class=\"jsx30matrix_resize_anchor\" jsxindex=\""+ec+"\" style=\"left:"+(sb-4)+"px;"+Wb+"width:"+4+"px;background-image:url("+w.SPACE+");height:"+Kc+"px;\" "+dc+">&#160;</div>");}return cc.join("");};f.Si=function(i,g){if(!i.leftButton())return;rc.publish(i);this.endEditSession();var Zb=this.getChildren().indexOf(this.pi()[Number(g.getAttribute("jsxindex"))]);this.xA(Zb);if(typeof(this._jsxwB)=="object"&&(new Date()).valueOf()-this._jsxwB.timestamp<200)return;var rb=this.doEvent(ic.BEFORE_RESIZE,{objEVENT:i,intCOLUMNINDEX:Zb});if(!(rb===false)){var xc=this.xw();var Cc=parseInt(g.style.left)-this.getScrollLeft();this._jsxresizeorigin={origin:Cc};xc.style.left=Cc+"px";ic.DM(i,xc,function(j,h){return [j,0];});rc.subscribe(rc.MOUSEUP,this,"Jv");}this._jsxwB={timestamp:(new Date()).valueOf()};i.cancelAll();};f.Xp=function(s,p){if(!s.leftButton())return;rc.publish(s);var nc=this.em(nc);X.trace("...still need logic here to find the widest cell and make the column exactly as wide, "+nc);s.cancelAll();};f.em=function(){return this._jsxtz;};f.xA=function(h){this._jsxtz=h;};f.xw=function(){return this.getRendered().childNodes[6];};f.uC=function(n){if(!n)n=this.getRendered();return n.childNodes[7];};f.xk=function(k){var Vb=this.uC(k);Vb.style.display="none";Vb.removeAttribute("dropverb");Vb.removeAttribute("rowcontext");};f.Jv=function(p){jsx3.EventHelp.reset();rc.unsubscribe(rc.MOUSEUP,this,"Jv");if(parseInt(this.xw().style.left)!=this._jsxresizeorigin.origin){var _=this.KG();var lc=this.getChildren().indexOf(this.pi()[this.em()]);var xb=this.doEvent(ic.AFTER_RESIZE,{objEVENT:p,vntWIDTH:_,intCOLUMNINDEX:lc});if(!(xb===false))this.getChild(this.em()).setWidth(_,true);this.oo();}this.xw().style.left="-6px";};f.KG=function(){var Db=this.xw();var wb=parseInt(Db.style.left);var sb=this.pi();var ub=this.Mv();var Gb=this.getChild(this.em()).getDisplayIndex();for(var W=0;W<Gb;W++)wb=wb-ub[W];wb=wb+this.getScrollLeft();return wb<b.MINIMUM_COLUMN_WIDTH?b.MINIMUM_COLUMN_WIDTH:wb;};f.getResizable=function(){return this.jsxresize;};f.setResizable=function(h){this.jsxresize=h;};f.pu=function(){this.RF();var bb=this.Zp(true)/this.getRowsPerPanel(b.DEFAULT_ROWS_PER_PANEL);if(bb>parseInt(bb))bb=parseInt(bb)+1;this.is(new Array(bb));};f.ut=function(p){if(this.getParent()==null)return;this.ct();this.endEditSession();this.TE();this.rv();this.OE();this.pu();var Tb=this.Zt().length;var x=this.getPagingModel(b.PAGING_OFF);if(x==b.PAGING_OFF||x==b.PAGING_STEPPED){var xc={painted:1,token:b.getToken(),index:0};if(this.getRenderingModel()=="hierarchical")xc.contextnodes=this.pl().childNodes;this.Zt()[0]=xc;this.an(xc);if(this.Lh()){var Yb={painted:1,token:b.getToken(),index:-1};this.an(Yb);}}else{this.pl().innerHTML="";if(x==b.PAGING_PAGED){if(this.Br(this.Zt().length-1))this.An().unshift({index:Tb-1});if(this.Br(0))this.An().unshift({index:0});this.ED();}else{if(x==b.PAGING_CHUNKED){for(var gb=0;gb<Tb;gb++)this.An().push({index:gb});if(this.Lh()==2){this.An().unshift({index:-1});}else{if(this.Lh()==1){this.An().push({index:-1});}}this.ED();}else{if(x==b.PAGING_2PASS){this.An().unshift({index:0});if(this.Lh()==2){this.An().unshift({index:-1});}else{if(this.Lh()==1){this.An().push({index:-1});}}this.ED();}}}var S=this.Dm(false);if(S){var R=this.pl();if(R.lastChild)jsx3.html.insertAdjacentHTML(R.lastChild,"BeforeEnd",S);else R.innerHTML=S;}}if(p!==false)this.oo();};f.Lh=function(){return this.getPagingModel()==b.PAGING_PAGED||this.getRenderingModel()=="hierarchical"?0:this.getAutoRow();};f.getAutoRow=function(){return this.jsxautorow;};f.setAutoRow=function(r){this.jsxautorow=r;};f.yp=function(){if(this.getPagingModel()==b.PAGING_PAGED){var Db=this.Zt();var bb=this.pl().childNodes.length;var pc=this.getPanelPoolSize(b.DEFAULT_PANEL_POOL_COUNT);var pb=bb-pc;if(pb>0){X.trace("Panel pool max ("+pc+") exceeded by: "+pb);var gb=this.rg();var hc=Db.length;if(hc/2>gb){pb=this.Xw(Db,hc-1,gb+1,pb,-1);if(pb<=0)return;pb=this.Xw(Db,0,gb-1,pb,1);if(pb<=0)return;}else{pb=this.Xw(Db,0,gb-1,pb,1);if(pb<=0)return;pb=this.Xw(Db,hc-1,gb+1,pb,-1);if(pb<=0)return;}}}};f.Xw=function(h,p,d,o,s){for(var Y=p;s==-1&&Y>d||s==1&&Y<d;Y=Y+s){if(h[Y]!=null){h[Y]=null;o--;X.trace("reaping panel: "+Y);var H=this.zi(Y);if(H)H.parentNode.removeChild(H);}if(o<=0)return 0;}return o;};f.cF=function(){var Ac=this.pl();var Hc=Ac.childNodes;for(var Rb=0;Rb<Hc.length;Rb++){if(Hc[Rb].tagName.toLowerCase()=="table"&&Hc[Rb].getAttribute("jsxautorow")!="true"||this.getRenderingModel()=="hierarchical"&&Hc[Rb].getAttribute("jsxtype")=="structure")return this.getRenderingModel()=="hierarchical"?Hc[Rb].firstChild:Hc[Rb];}};f.No=function(){var jc=this.pl();var Wb=jc.childNodes;for(var pc=Wb.length-1;pc>=0;pc--){if(Wb[pc].tagName.toLowerCase()=="table"&&Wb[pc].getAttribute("jsxautorow")!="true"||this.getRenderingModel()=="hierarchical"&&Wb[pc].getAttribute("jsxtype")=="structure")return this.getRenderingModel()=="hierarchical"?Wb[pc].firstChild:Wb[pc];}};f.no=function(){return this.zi(-1);};f.zi=function(g){var Hb=this.getDocument();return Hb.getElementById(this.getId()+"jsx_"+g);};f.jC=function(h){return parseInt((h.id+"").replace(this.getId()+"jsx_",""));};f.sg=function(a){if(a.parentNode.tagName.toLowerCase()=="table")return a.parentNode;return a.parentNode.parentNode;};f.Hl=function(e,i){if(!isNaN(e))e=this.zi(e);if(e){var jb=0;for(var Nb=0;Nb<e.childNodes.length;Nb++){if(e.childNodes[Nb].tagName.toLowerCase()=="tbody"){return e.childNodes[Nb].childNodes[i];}else{if(e.childNodes[Nb].tagName.toLowerCase()=="tr"){return e.childNodes[i+jb];}else{jb++;}}}}return null;};f.ae=function(s){var Yb=this.getId()+"_jsx_"+s;var jb=this.getDocument();return jb.getElementById(Yb);};f._y=function(i){var fc=this.ae(i);return fc?this.sg(this.ae(i)).parentNode:null;};f.gv=function(n,e){var Wb=this.pi();for(var Mb=0;Mb<Wb.length;Mb++){if(Wb[Mb].getPath()==e){var qb=this.getId()+"_jsx_"+n+"_jsx_"+Mb;var gb=this.getDocument();return gb.getElementById(qb);}}return null;};f.NF=function(i,s){var v=this.ae(i);return v?v.childNodes[s]:null;};f.VE=function(){var Kc=this.Hl(0,0);return Kc?Kc.childNodes[0]:null;};f.hg=function(g){return this.Hl(g,0);};f.LF=function(q){var ob=this.Hl(q,0);return ob?ob.parentNode.lastChild:null;};f.oD=function(o,k){this.collapseEditSession(o,k);};f.hx=function(e,h){this.collapseEditSession(e,h);};f.VG=function(k,a){var C=a.parentNode;var Xb=C.childNodes[0].childNodes[0];var Kb=C.childNodes[1].childNodes[0];var yc=a.scrollLeft;C.childNodes[1].scrollLeft=0;Xb.style.left="-"+yc+"px";Kb.style.left="-"+yc+"px";if(k)this.doEvent(ic.SCROLL,{objEVENT:k,strDIRECTION:"horizontal",intPOSITION:yc});};f.OA=function(l,a){var Zb=this.pl(a.parentNode);Zb.parentNode.scrollTop=0;this._jsxUE=a.scrollTop;Zb.style.top="-"+this._jsxUE+"px";var Jb=this.rg();if(this.getPagingModel(b.PAGING_OFF)==b.PAGING_PAGED){var xc=this.getScrollInfoLabel(b.DEFAULT_INFO_LABEL);if(xc!=""){this.Uc(a.parentNode).style.display="block";window.clearTimeout(this._jsxLu);var fb=this;this._jsxLu=window.setTimeout(function(){if(a&&a.parentNode)fb.Uc(a.parentNode).style.display="none";},1000);jsx3.sleep(function(){if(this.getParent()==null)return;if(a&&a.parentNode){var ab=this.getRowHeight(b.DEFAULT_ROW_HEIGHT);var yb=parseInt(this._jsxUE/ab)+1;var Ab=this.RL(true).P5();var R=this.Zp();var Yb=yb+parseInt(Ab/ab)-1;if(Yb>R)Yb=R;var nc=new jsx3.util.MessageFormat(xc);this.Uc(a.parentNode).childNodes[0].innerHTML=nc.format(yb,Yb,R);}},"Matrix_timeout"+this.getId(),this);}var ob;var kc=this.getPanelQueueSize(b.DEFAULT_PANEL_QUEUE_SIZE);var N=parseInt(kc/2);var Hc=kc-N;for(var fc=Jb+Hc;fc>=Jb-N;fc--){if(this.Br(fc)!=null){this.An().unshift({index:fc});if(this.An().length>kc)var qb=this.An().pop();ob=true;}}if(ob)this.ED(Zb);}this.doEvent(ic.SCROLL,{objEVENT:l,strDIRECTION:"vertical",intPOSITION:this._jsxUE});};f.Uc=function(r){return r.childNodes[5];};f.rg=function(){return parseInt(this._jsxUE/(this.getRowsPerPanel(b.DEFAULT_ROWS_PER_PANEL)*this.getRowHeight(b.DEFAULT_ROW_HEIGHT)));};f.ED=function(q){jsx3.sleep(function(){if(this.getParent()==null)return;if(this.An().length){var lc=this.An().shift();if(this.Br(lc.index))this.fh(this.Qn(lc.index),q,lc.index);if(this.An().length)this.ED(q);}},"ED"+this.getId(),this);};f.An=function(){return this._jsxUq;};f.RF=function(){this._jsxUq=[];};f.fh=function(n,h,p){if(!h)h=this.pl();if(h){var E={index:p,painted:1,token:b.getToken()};this.Zt()[p]=E;X.trace("fetching panel: "+p);jsx3.html.insertAdjacentHTML(h,"BeforeEnd",n);this.an(E);this._p(h);var G=this;window.setTimeout(function(){if(G.getParent()==null)return;G.yp();},this.getReaperInterval(b.DEFAULT_REAPER_INTERVAL));}};f.getIterableRows=function(){var Eb,Bb;var db=[];Bb=this.getRendered();if(Bb){if(this.getRenderingModel()=="hierarchical"){var F=this.getRenderingContext("jsxroot");var gc=this.getRecordNode(F);var cb=gc.selectNodes("record");var Cb=cb.getLength();var hb=[];for(var pc=0;pc<Cb;pc++){var sb=cb.getItem(pc).getAttribute("jsxid");hb.push(this._y(sb));}db=this.Lv({contextnodes:hb});}else{var Vb=Bb.childNodes[1].childNodes[0].childNodes;var zb;for(var pc=0;pc<Vb.length;pc++){zb=Vb[pc];zb=this.hg(zb);if(zb){zb=zb.parentNode;var rb=zb.childNodes.length;for(var nb=0;nb<rb;nb++){var jb=zb.childNodes[nb];if(jb.tagName.toLowerCase()=="tr")db.push(jb);}}}}}return db;};f.Lv=function(r){var F=[];if(r.contextnodes){for(var vc=0;vc<r.contextnodes.length;vc++){if(r.contextnodes[vc].getAttribute("jsxtype")=="structure")F=F.concat(this.md(r.contextnodes[vc]));}}else{var tb=r.index;var K=this.zi(tb);if(K){K=this.hg(K);if(K){K=K.parentNode;var Kc=K.childNodes.length;for(var z=0;z<Kc;z++){var oc=K.childNodes[z];if(oc.tagName.toLowerCase()=="tr")F.push(oc);}}}}return F;};f.md=function(j,l){if(l==null)l=[];l.push(this.hg(j.firstChild));if(j.lastChild){var Nc=j.lastChild.childNodes;for(var _=0;_<Nc.length;_++){if(Nc[_].tagName)this.md(Nc[_],l);}}return l;};b.yz=0;b.getToken=function(){b.yz+=1;return b.yz;};f.getContentElement=function(d,n){var Vb=this.gv(d,n);if(Vb){if(Vb.cellIndex==0&&this.getRenderingModel()=="hierarchical"&&this.getRenderNavigators(1)!=0){var qc=Vb.childNodes[0].childNodes[0];while(qc&&qc.tagName.toLowerCase()!="tr")qc=qc.childNodes[0];if(qc)return qc.lastChild;}else{return Vb.childNodes[0];}}};f.an=function(g,s){if(this.Zp()==0&&!this.Lh())return;var Ab=this.getServer();var fc=this.pi();for(var Ac=0;Ac<fc.length;Ac++){var db=fc[Ac].Nm();if(!db){continue;}else{if(!s){s=this.Lv(g);if(g.contextnodes){g.index=true;delete g.contextnodes;}}var Nc=s.length;if(Nc==0)return;for(var U=0;U<Nc;U++){var Jc=s[U];if(Ac==0&&this.getRenderingModel()=="hierarchical"&&this.getRenderNavigators(1)!=0){var Tb=Jc.childNodes[0].childNodes[0].childNodes[0];while(Tb&&Tb.tagName.toLowerCase()!="tr")Tb=Tb.childNodes[0];if(Tb){var Hc=Tb.lastChild;}else{continue;}}else{if(Jc.childNodes[Ac]){var Hc=Jc.childNodes[Ac].childNodes[0];}else{continue;}}this.Ce(db,Hc,Jc.getAttribute("jsxid"),fc[Ac],Jc.getAttribute("jsxrownumber"),g);}}}};f.Ce=function(s,p,q,k,j,h){if(this._jsxEl==null)this._jsxEl=[];this._jsxEl.push([s,p,q,k,j,h]);jsx3.sleep(this.gD,"Matrix2pass"+this.getId(),this);};f.gD=function(){if(this.getParent()==null){this._jsxEl=[];return;}var gb=this.getServer();var pc=(new Date()).getTime();var Hc=pc;while(this._jsxEl.length>0&&Hc-pc<b.fv){var db=this._jsxEl.shift();var ob=db[5];var kb=ob.index;if(!kb){var Mb=this.Zt()[ob.index];kb=Mb!=null&&Mb.token==ob.token;}if(kb){db[0].format(db[1],db[2],this,db[3],db[4],gb);Hc=(new Date()).getTime();}}if(this._jsxEl.length>0)jsx3.sleep(this.gD,"Matrix2pass"+this.getId(),this);};f.pl=function(n){if(!n)n=this.getRendered();return n?n.childNodes[1].childNodes[0]:null;};f.Qj=function(){var Jc=this.getPagingModel(b.PAGING_OFF);if(Jc==b.PAGING_PAGED){var J=this.Zp()*this.getRowHeight(b.DEFAULT_ROW_HEIGHT);}else{var yb=this.pl();J=yb?parseInt(yb.offsetHeight):0;}return J;};f.Br=function(o){if(o==-1||o>=0&&o<this.Zt().length&&this.Zt()[o]==null){var Jb=this.getDocument();var Hb=Jb.getElementById(this.getId()+"jsx_"+o);return !Hb;}return false;};f.Qn=function(n){var Gb=this.RL(true);var Kb=this.getRowsPerPanel(b.DEFAULT_ROWS_PER_PANEL);var P=this.getPagingModel(b.PAGING_OFF);if(P==b.PAGING_PAGED){var J=this.getRowHeight(b.DEFAULT_ROW_HEIGHT);var T="position:absolute;left:0px;top:"+Kb*J*n+"px;";var Tb=Kb*n;var Jc=Tb+Kb+1;}else{var T="position:relative;";var sc="";if(P==b.PAGING_CHUNKED){var Tb=Kb*n;var Jc=Tb+Kb+1;}else{var O=this.Zp();var Tb=0;var Jc=O+1;}}var Eb={};Eb.jsx_min_exclusive=Tb;Eb.jsx_max_exclusive=Jc;Eb.jsx_panel_index=n;Eb.jsx_panel_css=T;Eb.jsx_column_widths=this.zF();Eb.jsx_rendering_context=this.getRenderingContext("jsxroot");Eb.jsx_mode=n==-1?"autorow":"panel";X.trace("Fetching records: "+Tb+" - to - "+Jc);return this.doTransform(Eb);};f.resetXmlCacheData=function(h){this.Wc(true);this.jsxsupermix(h);};f.setXMLId=function(m){this.Wc(true);return this.jsxsupermix(m);};f.repaint=function(){this.Wc(true);return this.jsxsuper();};f.setXMLString=function(q){this.Wc(true);return this.jsxsupermix(q);};f.setXMLURL=function(p){this.Wc(true);return this.jsxsupermix(p);};f.getXSL=function(){return this.mC();};f.mC=function(i){var sb=jsx3.getSharedCache().getOrOpenDocument(b.DEFAULT_XSL_URL);if(i)return sb;var Dc=this.getServer().getCache();var gc=Dc.getDocument(this.getXSLId());if(gc==null){gc=sb.cloneDocument();Dc.setDocument(this.getXSLId(),gc);gc._jsx_matrix_configured=true;gc.setSelectionNamespaces("xmlns:xsl='http://www.w3.org/1999/XSL/Transform'");var Ic=this.getRenderingModel("deep");var Gc=this.pi();var T=gc.selectSingleNode("//xsl:template[@name='row_template']//tr");var sc=gc.selectSingleNode("//xsl:template[@name='row_template']//tr/xsl:choose/xsl:when");var dc=this.zF();for(var M=0;M<Gc.length;M++){var W=Gc[M];var ec=W.RL(true).pQ(1);var Gb=ec.pQ(0);var K=this.CI()+this.RX(rc.FOCUS,"Dz")+this.RX(rc.BLUR,"km");var rb=M==0&&Ic=="hierarchical"?" colspan=\"{$jsx_colspan}\" jsxcolspan=\"{$jsx_colspan}\" ":"";ec.setAttributes(K+rb+" jsxtype=\"cell\" class=\"jsx30matrixcolumn_cell\" unselectable=\"on\" id=\"{$jsx_id}_jsx_{$jsx_cdfkey}_jsx_"+M+"\"");ec.setStyles(W.T8()+W.a7()+W.bR()+W.jP()+W.N_()+W.jW()+W.q6()+"{$jsx_selection_bg}{$jsx_rowbg}");Gb.setAttributes("class=\"jsx30matrixcolumn_cell_value\" unselectable=\"on\"");Gb.setStyles(W.KY()+W.c_());var Yb=b.so.format(W.getId()+"_value");var Eb=new jsx3.xml.Document();Eb.loadXML(Yb);if(!Eb.hasError()){Eb.setSelectionNamespaces("xmlns:xsl='http://www.w3.org/1999/XSL/Transform'");var Qb=gc.selectSingleNode("//xsl:choose/xsl:when/xsl:choose");Qb.appendChild(Eb.getRootNode());}if(Ic=="hierarchical"&&M==0&&this.getRenderNavigators(1)!=0){var kc=b.wB.format("ui_controller");var Cc=gc.selectSingleNode("//xsl:template[@name='ui_controller']//xsl:call-template");Cc.setAttribute("name",W.getId()+"_value");}else{var kc=b.wB.format(W.getId()+"_value");}var cc="";var Hb=W.getEditMask();if(Hb!=null&&this.rj(Hb)&&Hb.emGetType()==b.EditMask.FORMAT)cc=Hb.emPaintTemplate().replace(/\{0\}/g,"@"+W.getPath());var kc=ec.paint().join(Gb.paint().join(kc));var H=/width:\d*px;/;var Vb=kc.match(H);var R=b.ld.format(W.getId(),kc,"##JSX_REPLACE##");var F=(Vb+"").split(":");var Db=parseInt(F[1]);var jb=M==0?dc-this.Mv()[0]+Db:Db;R=R.replace(Vb,"{$jsx_first_row_width_style}").replace("##JSX_REPLACE##","'"+Db+"'").replace("##JSX_REPLACE_ALL##",jb);Eb=new jsx3.xml.Document();Eb.loadXML(R);if(!Eb.hasError()){gc.getRootNode().appendChild(Eb.getRootNode());}var Bb=W.getValueTemplate(jsx3.gui.Matrix.Column.TEMPLATES["default"]).replace(/\{0\}/g,"@"+W.getPath());Eb=new jsx3.xml.Document();Eb.loadXML(Bb);if(!Eb.hasError()){Eb.getRootNode().setAttribute("name",W.getId()+"_value");gc.getRootNode().appendChild(Eb.getRootNode());}if(cc!=""){Eb=new jsx3.xml.Document();Eb.loadXML(cc);if(!Eb.hasError()){var nb=gc.selectSingleNode("//xsl:template[@name='"+W.getId()+"_value']");nb.appendChild(Eb.getRootNode());}else{X.error("Could not create valid XSLT for the edit mask owned by the column, '"+W.getId()+"':\n\t"+Eb.getError().description);}}var v=b.rF.format(W.getId());Eb=new jsx3.xml.Document();Eb.loadXML(v);if(!Eb.hasError()){if(M==0)T.insertBefore(Eb.getRootNode(),sc.getParent());else sc.appendChild(Eb.getRootNode());}}}return gc;};b.Zw=function(a){return a&&a.getDisplay()!=w.DISPLAYNONE;};f.pi=function(){return this.getChildren().filter(b.Zw);};f.doTransform=function(m){if(!m)m={};m.jsx_id=this.getId();m.jsx_rendering_model=this.getRenderingModel("deep");m.jsx_paging_model=this.getPagingModel(b.PAGING_OFF);var hc=this.getUriResolver();if(m.jsx_rendering_model=="hierarchical"){if(m.jsx_icon==null)m.jsx_icon=hc.resolveURI(this.getIcon(b.ICON));if(m.jsx_icon_minus==null)m.jsx_icon_minus=hc.resolveURI(this.getIconMinus(b.ICON_MINUS));if(m.jsx_icon_plus==null)m.jsx_icon_plus=hc.resolveURI(this.getIconPlus(b.ICON_PLUS));m.jsx_transparent_image=w.SPACE;}m.jsx_sort_path=this.getSortPath();m.jsx_sort_direction=this.getSortDirection();m.jsx_sort_type=this.getSortType();m.jsx_selection_model=this.getSelectionModel(b.SELECTION_ROW);m.jsx_selection_bg_url=this.Il();var Ob=this.getXSLParams();for(var cc in Ob)m[cc]=Ob[cc];if(m.jsx_use_categories&&this.getRenderingModel()!="hierarchical")delete m.jsx_use_categories;m.jsx_column_count=this.pi().length;m.jsxpath=jsx3.getEnv("jsxabspath");m.jsxpathapps=jsx3.getEnv("jsxhomepath");m.jsxpathprefix=this.getUriResolver().getUriPrefix();var y=this.jsxsupermix(m);y=y.replace(/<\/*JSX_FF_WELLFORMED_WRAPPER[^>]*>/g,"");return !m.jsx_return_at_all_costs&&y.indexOf("<tr")==-1?"":y;};f.Wc=function(h){if(!this.getServer())return;delete this._jsxck;if(!h){this.resetXslCacheData();this.vQ(true);delete this._jsxwg;}};f.getSortedIds=function(){var Ec=this.doTransform({jsx_mode:"sort",jsx_return_at_all_costs:true});return Ec.search(/<ids>([\s\S]*)\s*,\s*<\/ids>/)>-1?window.eval("["+RegExp.$1+"]"):[];};f.Zp=function(s){if(s)delete this._jsxck;if(this._jsxck){return this._jsxck.maxlen;}else{var wc={};wc.jsx_mode="count";wc.jsx_rendering_model=this.getRenderingModel("deep");wc.jsx_rendering_context=this.getRenderingContext("jsxroot");var zb=new jsx3.xml.Processor(this.getXML(),this.mC(true),wc);var C=zb.transform();var M=C.search(/(\d+)/)>-1?parseInt(RegExp.$1):0;X.trace("Getting Record Count: "+M);this._jsxck={maxlen:M};if(this.getPagingModel()==b.PAGING_PAGED){var sc=this.RL();var G=this.getRendered();if(sc&&G){sc=sc.pQ(2).pQ(0);var Mc=this.getRowHeight(b.DEFAULT_ROW_HEIGHT)*M;sc.recalculate({height:Mc},G.childNodes[2].childNodes[0],null);}}return M;}};f.Zt=function(){return this._jsxEu;};f.is=function(h){this._jsxEu=h;};f.getSelectionModel=function(i){return this.jsxselectionmodel!=null?this.jsxselectionmodel>b.SELECTION_MULTI_ROW?b.SELECTION_UNSELECTABLE:this.jsxselectionmodel:i!=null?i:null;};f.setSelectionModel=function(s){this.jsxselectionmodel=s;};f.getRowHeight=function(l){return this.jsxrowheight!=null?this.jsxrowheight:l!=null?l:null;};f.setRowHeight=function(g,e){this.jsxrowheight=g;this.Wc();if(!e)this.repaint();};f.getRowsPerPanel=function(m){return this.jsxrowsperpanel?this.jsxrowsperpanel:m?m:null;};f.setRowsPerPanel=function(q,n){this.jsxrowsperpanel=q;this.Wc(true);if(!n)this.repaint();};f.getPanelQueueSize=function(g){return this.jsxpaintqueuesize?this.jsxpaintqueuesize:g?g:null;};f.setPanelQueueSize=function(q){this.jsxpaintqueuesize=q;};f.getReaperInterval=function(p){return this.jsxreaperinterval?this.jsxreaperinterval:p?p:null;};f.setReaperInterval=function(g){this.jsxreaperinterval=g;};f.getPanelPoolSize=function(h){return this.jsxpanelpoolsize?this.jsxpanelpoolsize:h?h:null;};f.setPanelPoolSize=function(k){this.jsxpanelpoolsize=k;this.Wc(true);};f.getPagingModel=function(m){if(this.getRenderingModel()=="hierarchical"&&this.jsxpagingmodel!=b.PAGING_STEPPED){X.trace("The paging model was overridden (disabled) because the rendering mode is hierarchical and stepped paging was not explicitly set.");return b.PAGING_OFF;}return !isNaN(this.jsxpagingmodel)?this.jsxpagingmodel:!isNaN(m)?m:null;};f.setPagingModel=function(c){this.jsxpagingmodel=c;this.Wc();};f.getHeaderHeight=function(j){return this.jsxheaderheight!=null?Number(this.jsxheaderheight):j?j:null;};f.setHeaderHeight=function(k,c){this.jsxheaderheight=k;this.vQ(true);if(!c)this.repaint();};f.getScrollInfoLabel=function(j){return this.jsxscrollinfolabel!=null?this.jsxscrollinfolabel:j?j:null;};f.setScrollInfoLabel=function(e){this.jsxscrollinfolabel=e;};f.getScrollLeft=function(){var Sb=this.getRendered();return Sb?Sb.childNodes[3].scrollLeft:0;};f.setScrollLeft=function(l){var uc=this.getRendered();if(uc&&uc.childNodes[3]){uc.childNodes[3].scrollLeft=l;if(uc.childNodes[3].style.display=="none")this.VG(false,uc.childNodes[3]);}};f.getScrollTop=function(){return this._jsxUE?this._jsxUE:0;};f.NB=function(){var Fb=this.getRendered();return Fb&&Fb.childNodes[2]?Fb.childNodes[2].scrollTop:this.getScrollTop();};f.setScrollTop=function(m){var Vb=this.getRendered();if(Vb&&Vb.childNodes[2])Vb.childNodes[2].scrollTop=m;};f.synchronizeVScroller=function(){this._p();};f._p=function(n){if(!n)n=this.pl();if(!n)return;if(this.getPagingModel()!=b.PAGING_PAGED){var Hc=this.RL().pQ(2).pQ(0);Hc.recalculate({height:n.offsetHeight+this.getHeaderHeight(b.DEFAULT_HEADER_HEIGHT)},n.parentNode.parentNode.childNodes[2].childNodes[0],null);var oc=this.NB();if(this.getScrollTop()!=oc){this.setScrollTop(oc);n.style.top="-"+oc+"px";}}if(n.parentNode.parentNode.childNodes[3].style.display=="none")this.setScrollLeft(0);this.bF();};f.bF=function(){var ec=this.getRendered();if(ec)ec.childNodes[4].style.display=this.getSuppressVScroller(0)==1?"none":"";};f.getScaleWidth=function(){return this.jsxscalewidth;};f.setScaleWidth=function(j){this.jsxscalewidth=j;this.C5();return this;};f.onSetChild=function(d){if(d instanceof jsx3.gui.Matrix.Column){this.Wc();return true;}return false;};f.paintChild=function(r,j){if(!j)this.repaint();};f.onRemoveChild=function(s,h){this.Wc();this.repaint();};f.getHeaderBorder=function(){return this.jsxheaderborder;};f.setHeaderBorder=function(e){this.jsxheaderborder=e;this.vQ(true);this.repaintHead();};f.getBodyBorder=function(){return this.jsxbodyborder;};f.setBodyBorder=function(h,j){this.jsxbodyborder=h;this.Wc();if(!j)this.repaint();};f.getValue=function(){var Ac=this.getSelectionModel();var Jb=this.getSelectedNodes();var P=Jb.getLength();var Nb=[];if(Ac==b.SELECTION_MULTI_ROW){for(var kc=0;kc<P;kc++)Nb.push(Jb.getItem(kc).getAttribute("jsxid"));}else{return P?Jb.getItem(0).getAttribute("jsxid"):null;}return Nb;};f.getRenderingModel=function(o){return this.jsxrenderingmodel?this.jsxrenderingmodel:o?o:null;};f.setRenderingModel=function(q,c){this.jsxrenderingmodel=q;this.Wc();if(!c)this.repaint();};f.getRenderingContext=function(j){return this.jsxrenderingcontext!=null&&this.jsxrenderingcontext!=""?this.jsxrenderingcontext:j!=null?j:null;};f.setRenderingContext=function(i,c){this.jsxrenderingcontext=i;this.Wc(true);if(!c)this.repaint();};f.getSuppressHScroller=function(i){return this.jsxsuppresshscroll!=null?this.jsxsuppresshscroll:i!=null?i:null;};f.setSuppressHScroller=function(l){this.jsxsuppresshscroll=l;var Lc=this.getRendered();if(Lc&&Lc.childNodes[3]){Lc.childNodes[3].style.display=l!=1?"block":"none";this.bF();}};f.getSuppressVScroller=function(g){return this.jsxsuppressvscroll!=null?this.jsxsuppressvscroll:g!=null?g:null;};f.setSuppressVScroller=function(i,e){this.jsxsuppressvscroll=i;this.Wc();if(e){var W=this.getRendered();if(W&&W.childNodes[2]){W.childNodes[2].style.display=i!=1?"block":"none";this.bF();}}else{this.repaint();}};f.getFixedColumnIndex=function(j){return this.jsxfixedcolumnindex!=null?this.jsxfixedcolumnindex:j!=null?j:null;};f.setFixedColumnIndex=function(h){this.jsxfixedcolumnindex=h;};f.getRenderNavigators=function(j){return this.jsxrendernavigators!=null?this.jsxrendernavigators:j!=null?j:null;};f.setRenderNavigators=function(k,c){this.jsxrendernavigators=k;this.Wc();if(!c)this.repaint();};f.getIcon=function(l){return this.jsxicon!=null&&this.jsxicon!=""?this.jsxicon:l?l:null;};f.setIcon=function(h){this.jsxicon=h;};f.getIconMinus=function(l){return this.jsxiconminus!=null&&this.jsxiconminus!=""?this.jsxiconminus:l?l:null;};f.setIconMinus=function(h){this.jsxiconminus=h;};f.getIconPlus=function(q){return this.jsxiconplus!=null&&this.jsxiconplus!=""?this.jsxiconplus:q?q:null;};f.setIconPlus=function(r){this.jsxiconplus=r;};f.insertRecordProperty=function(o,i,h,j){if(i=="jsxid"){var _b=this.jsxsupermix(o,i,h,false);var Jc=this.ae(o);if(Jc){Jc.setAttribute("jsxid",h);Jc.setAttribute("JSXDRAGID",h);var pb=this.getId()+"_jsx_"+h;Jc.setAttribute("id",pb);var J=Jc.childNodes;pb=pb+"_jsx_";for(var jc=0;jc<J.length;jc++)J[jc].setAttribute("id",pb+jc);if(j!=false)this.redrawRecord(h,jsx3.xml.CDF.UPDATE);return _b;}}else{return this.jsxsupermix(o,i,h,j);}};f.redrawCell=function(e,i,r){var F=this.NF(e,i.getDisplayIndex());if(F){var lc=F.childNodes[0];if(this.getRenderingModel()=="hierarchical"&&i.getChildIndex()==0&&this.getRenderNavigators(1)!=0){while(lc&&lc.tagName.toLowerCase()!="tr")lc=lc.childNodes[0];if(lc){lc=lc.lastChild;}else{X.error("redrawCell can not resolve the on-screen HTML element ot update");return;}}var G={};G.jsx_return_at_all_costs=true;G.jsx_mode="cellvalue";G.jsx_record_context=e;G.jsx_cell_value_template_id=i.getId()+"_value";var Y=this.doTransform(G);lc.innerHTML=Y;var cb=i.Nm();if(cb){var Mc=F.parentNode;cb.format(lc,Mc.getAttribute("jsxid"),this,i,Mc.getAttribute("jsxrownumber"),this.getServer());}if(!r){var C=this.pi();var Mb=new RegExp("\\b("+i.getPath()+")\\b");for(var t=0;t<C.length;t++){var H=C[t].getTriggers()+"";if(C[t]!=i&&(C[t].getPath()==i.getPath()||H.search(Mb)>=0))this.redrawCell(e,C[t],true);}}}};f.redrawMappedCells=function(g,r){var cc=this.pi();for(var R=0;R<cc.length;R++){if(cc[R].getPath()==r){this.redrawCell(g,cc[R],false);return;}}};f.Tq=function(g,a){return this.doTransform({jsx_mode:"record",jsx_panel_css:"position:relative;",jsx_column_widths:this.zF(),jsx_context_index:a?a:1,jsx_rendering_context:this.getRecordNode(g).getParent().getAttribute("jsxid"),jsx_rendering_context_child:g});};f.redrawRecord=function(h,s){var Gc=this.pl();if(h!=null&&s==jsx3.xml.CDF.UPDATE){if(this.getRenderingModel()=="hierarchical"){var nb=this._y(h);var Z=nb.parentNode;var wc=this.Tq(h,Z.getAttribute("jsxcontextindex"));jsx3.html.setOuterHTML(nb,wc);nb=this._y(h);var Hb={painted:1,token:b.getToken(),contextnodes:[nb]};this.Zt()[0]=Hb;this.an(Hb);}else{var L=this.pi();for(var M=0;M<L.length;M++)this.redrawCell(h,L[M],true);}}else{if(h!=null&&s==jsx3.xml.CDF.DELETE){if(this.getRenderingModel()=="hierarchical"){var N=this._y(h);if(N){var Fb=N.parentNode;Fb.removeChild(N);if(Fb.childNodes.length==0){var _=Fb.previousSibling;var C=this.hg(_);if(C){var v=C.getAttribute("jsxid");this.redrawRecord(v,jsx3.xml.CDF.UPDATE);}}this._p();}}else{if(this.getPagingModel(b.PAGING_OFF)!=b.PAGING_PAGED){var N=this.ae(h);if(N){var z=N.parentNode;if(z.childNodes.length==1){if(z.tagName.toLowerCase()!="table")z=z.parentNode;z.parentNode.removeChild(z);}else{var fc=N.nextSibling;if(N.parentNode.firstChild==N&&fc){for(var M=0;M<N.childNodes.length;M++)fc.childNodes[M].style.width=N.childNodes[M].style.width;}N.parentNode.removeChild(N);this._p();}}}else{this.repaint();}}}else{if(h!=null&&s==jsx3.xml.CDF.INSERTBEFORE){if(this.getPagingModel(b.PAGING_OFF)!=b.PAGING_PAGED){var eb=this.getRecordNode(h);var jb=eb.getNextSibling();var Bb=jb.getAttribute("jsxid");if(this.getRenderingModel()=="hierarchical"){var pb=this._y(Bb);var wc=this.Tq(h,pb.parentNode.getAttribute("jsxcontextindex"));jsx3.html.insertAdjacentHTML(pb,"BeforeBegin",wc);var Hb={painted:1,token:b.getToken(),contextnodes:[pb.previousSibling]};this.Zt()[0]=Hb;this.an(Hb);this._p(Gc);}else{var vb=this.ae(Bb);var Cc=vb.parentNode;var Tb=this.xu(Cc,h);Cc.insertBefore(Tb,vb);if(Cc.firstChild==Tb){for(var M=0;M<Tb.childNodes.length;M++){Tb.childNodes[M].style.width=vb.childNodes[M].style.width;vb.childNodes[M].style.width="";}}this.jy(Tb,h);this._p(Gc);}}else{this.repaint();}}else{if(h!=null&&s==jsx3.xml.CDF.INSERT){if(this.getPagingModel(b.PAGING_OFF)!=b.PAGING_PAGED){if(this.getRenderingModel()=="hierarchical"){var Lb=this.getRecordNode(h).getParent().getAttribute("jsxid");var nb=this._y(Lb);var Z=nb.lastChild;if(this._j(Z)){this.toggleItem(Lb,true);}else{var wc=this.Tq(h,Z.getAttribute("jsxcontextindex"));jsx3.html.insertAdjacentHTML(Z,"BeforeEnd",wc);var Hb={painted:1,token:b.getToken(),contextnodes:[Z.lastChild]};this.Zt()[0]=Hb;this.an(Hb);this._p(Gc);}}else{var Cc=this.No();if(Cc==null||Cc.firstChild==null){this.repaintData();}else{if(Cc.firstChild.tagName.toLowerCase()=="tbody")Cc=Cc.firstChild;var Tb=this.xu(Cc,h);Cc.appendChild(Tb);this.jy(Tb,h);this._p(Gc);}}}else{this.repaint();}}}}}};f._j=function(g){return g.childNodes.length==0||g.childNodes.length==1&&g.childNodes[0].nodeType!=1;};f.jy=function(l,d){var Xb=this.pi();for(var N=0;N<Xb.length;N++){var fc=Xb[N];var vc=fc.Nm();if(vc){var H=l.childNodes[N].childNodes[0];vc.format(H,d,this,fc,l.getAttribute("jsxrownumber"),this.getServer());}}};f.xu=function(e,l){var ob=this.getDocument();var Ec={};Ec.jsx_column_widths=this.zF();Ec.jsx_rendering_context=this.getRecordNode(l).getParent().getAttribute("jsxid");Ec.jsx_rendering_context_child=l;Ec.jsx_mode="record";var _=this.doTransform(Ec);var db=new jsx3.xml.Document();db.loadXML(_);var kb=db.getRootNode();var ec=ob.createElement("tr");b.Rz(kb,ec);var H=kb.getChildNodes();for(var x=0;x<H.getLength();x++){kb=H.getItem(x);var A=ob.createElement("td");b.Rz(kb,A);ec.appendChild(A);A.innerHTML=kb.getFirstChild().getXML();}return ec;};b.Rz=function(o,c){var ec=o.getAttributes();for(var Hb=0;Hb<ec.getLength();Hb++){var D=ec.getItem(Hb);var Cc=D.getNodeName();var E=/^(on(?:mousedown|click|focus|blur|mouseup|mouseover|mouseout|dblclick|scroll|keydown|keypress))/i;var fc=D.getValue();if(Cc.match(E)){jsx3.html.addEventListener(c,Cc.toLowerCase(),fc);}else{if(Cc=="class"){c.className=fc;}else{if(Cc=="style"){jsx3.gui.Painted.HM(c,fc);}else{c.setAttribute(Cc,fc);}}}}};f.getMaskProperties=function(){return w.MASK_NO_EDIT;};f.onDestroy=function(a){this.jsxsuper(a);this.onDestroyCached(a);};});jsx3.Class.defineClass("jsx3.gui.Matrix.ColumnFormat",null,null,function(b,k){var O=jsx3.gui.Matrix;b.sA={medium:1,full:1};b.sA["short"]=b.sA["long"]=1;b.Tv={integer:1,percent:1,currency:1};b.mx={unescape:"Ng",unescape_all:"yF",lookup:"qh"};b.getInstance=function(g,j){var P=null;var x=null;if(g.charAt(0)=="@"&&(x=b.mx[g.substring(1)])!=null){P=new b();P.format=b[x];}else{if(g.match(/^@(datetime|date|time|number)\b/)){P=new O.MessageFormat(j,"{0,"+g.substring(1)+"}");}else{if(g.indexOf("@message")==0){P=new O.MessageFormat(j,g.substring(9));}}}return P;};k.init=function(){};k.validate=function(){return true;};k.format=jsx3.Method.newAbstract("objDiv","strCDFKey","objMatrix","objMatrixColumn","intRowNumber","objServer");b.Ng=function(g,o,c,a,l,s){b.yF(g,o,c,a,l,s,jsx3.xml.Processor.supports(jsx3.xml.Processor.DISABLE_OUTPUT_ESCAPING));};b.yF=function(o,r,e,l,i,n,j){if(!j)o.innerHTML=o.innerHTML.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,"\"").replace(/&amp;/g,"&");};b.qh=function(m,a,i,n,g,p){var Lb=n.getEditMask();if(Lb!=null&&typeof(Lb.getRecordNode)=="function"){var zb=i.getRecordNode(a);if(zb){var dc=n.getValueForRecord(a);var Nc=Lb.getRecordNode(dc);m.innerHTML=Nc!=null?Nc.getAttribute("jsxtext"):dc!=null?dc.escapeHTML():"";}}};});jsx3.Class.defineClass("jsx3.gui.Matrix.MessageFormat",jsx3.gui.Matrix.ColumnFormat,null,function(m,h){h.init=function(j,i){this.Nz=new jsx3.util.MessageFormat(i,j.getServer().getLocale());};h.format=function(f,b,n,o,s,d){var bb=o.getValueForRecord(b);if(bb){try{f.innerHTML=this.Nz.format(bb);}catch(Kc){jsx3.util.Logger.GLOBAL.error(this.Nz,jsx3.NativeError.wrap(Kc));}}};});jsx3.Class.defineInterface("jsx3.gui.Matrix.EditMask",null,function(l,k){var Nc=jsx3.gui.Matrix;l.NORMAL=1;l.FORMAT=2;l.DIALOG=3;k.emInit=function(i){};k.emGetType=function(){return l.NORMAL;};k.emPaintTemplate=function(){return this.paint();};k.Dp=function(i,f,r,n,p,q,d){this._jsxCG={matrix:n,column:p,recordId:q,td:d};return this.emBeginEdit(i,f,r,n,p,q,d)!==false;};k.emBeginEdit=function(b,m,n,g,d,j,r){};k.Up=function(){var Gb=this.emEndEdit();delete this._jsxCG;return Gb;};k.emEndEdit=function(){return this.emGetValue();};k.emGetValue=function(){return null;};k.suspendEditSession=function(){this.getAncestorOfType(Nc)._jsxHk.GF=true;};k.resumeEditSession=function(){this.getAncestorOfType(Nc)._jsxHk.GF=false;};k.emGetSession=function(){return this._jsxCG;};k.commitEditMask=function(b,o){if(this._jsxCG)this._jsxCG.matrix.Jj(b,o);};k.emCollapseEdit=function(o){};});jsx3.Class.defineInterface("jsx3.gui.Matrix.BlockMask",jsx3.gui.Matrix.EditMask,function(m,d){var oc=jsx3.gui.Matrix;var E=jsx3.gui.Block;d.emInit=function(a){this.setDisplay(E.DISPLAYNONE,true);this.setLeft(0,true);this.setTop(0,true);this.setRelativePosition(E.ABSOLUTE,true);};d.emGetType=function(){return oc.EditMask.NORMAL;};d.emBeginEdit=function(l,c,q,h,g,a,o){this.setLeft(c.L,true);this.setTop(c.T,true);if(isNaN(this.getWidth()))this.setWidth(c.W,true);if(isNaN(this.getHeight()))this.setHeight(c.H,true);this.setDisplay(E.DISPLAYBLOCK,true);this.setMaskValue(l);var uc=this.getMaskFirstResponder()||this;uc.focus();};d.emGetValue=function(){return this.getMaskValue();};d.getMaskFirstResponder=function(){return this.qA();};d.getMaskValue=function(){var hb=this.qA();return hb!=null?hb.getValue():null;};d.setMaskValue=function(n){var xb=this.qA();if(xb!=null)xb.setValue(n);};d.qA=function(){return this.getDescendantsOfType(jsx3.gui.Form)[0];};d.emEndEdit=function(){var Nb=this.getMaskValue();this.setDisplay(E.DISPLAYNONE,true);return Nb;};});jsx3.Class.defineInterface("jsx3.gui.Matrix.DialogMask",jsx3.gui.Matrix.BlockMask,function(m,l){var pc=jsx3.gui.Matrix;l.emInit=function(h){pc.BlockMask.prototype.emInit.call(this,h);var T=this.getParent();while(T!=null){if(jsx3.gui.Window&&T instanceof jsx3.gui.Window){T=T.getRootBlock();break;}else{if(jsx3.gui.Dialog&&T instanceof jsx3.gui.Dialog){break;}}T=T.getParent();}if(T==null)T=this.getServer().getRootBlock();T.paintChild(this);};l.emGetType=function(){return pc.EditMask.DIALOG;};l.emBeginEdit=function(e,j,b,r,a,g,h){this._jsxCG={matrix:r,column:a,recordId:g,td:h};if(this.getLeft()==0&&this.getTop()==0){var Bb=jsx3.html.getRelativePosition(this.getRendered(h).parentNode,h);this.setLeft(Bb.L,true);this.setTop(Bb.T+Bb.H,true);}this.setDisplay(jsx3.gui.Block.DISPLAYBLOCK,true);this.setMaskValue(e);var Gb=this.getMaskFirstResponder()||this;Gb.focus();};l.qA=function(){var Kb=this.getChild(0)==this.getCaptionBar()?this.getChild(1):this.getChild(0);return Kb!=null?Kb.getDescendantsOfType(jsx3.gui.Form)[0]:null;};});
